{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from 'react';\nimport { Link } from '../routes';\nimport Navbar from 'react-bootstrap/Navbar';\nimport Nav from 'react-bootstrap/Nav';\nimport Container from 'react-bootstrap/Nav';\nimport Form from 'react-bootstrap/Form';\nimport FormControl from 'react-bootstrap/FormControl';\nimport Button from 'react-bootstrap/Button';\nimport { Card, Table } from 'react-bootstrap';\nimport factory from '../ethereum/factory';\nimport web3 from '../ethereum/web3';\nimport { Router } from '../routes';\n\nvar Index = /*#__PURE__*/function (_Component) {\n  _inherits(Index, _Component);\n\n  var _super = _createSuper(Index);\n\n  function Index(props) {\n    var _this;\n\n    _classCallCheck(this, Index);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      loading: false,\n      loading2: false,\n      errorMessage: ''\n    });\n\n    _this.state = {\n      loading: false,\n      loading2: false,\n      errorMessage: ''\n    }; // 為了讓 `this` 能在 callback 中被使用，這裡的綁定是必要的：\n\n    _this.login = _this.login.bind(_assertThisInitialized(_this));\n    _this.create = _this.create.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(Index, [{\n    key: \"login\",\n    value: function () {\n      var _login = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(event) {\n        var accounts, addr;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                event.preventDefault();\n                this.setState({\n                  loading: true\n                });\n                _context.next = 5;\n                return web3.eth.getAccounts();\n\n              case 5:\n                accounts = _context.sent;\n                _context.next = 8;\n                return factory.methods.return_addr(accounts[0]).call();\n\n              case 8:\n                addr = _context.sent;\n                if (addr != null) Router.pushRoute(\"/home/\".concat(addr));else alert(\"please create a mailbox first!\");\n                this.setState({\n                  loading: false\n                });\n                _context.next = 17;\n                break;\n\n              case 13:\n                _context.prev = 13;\n                _context.t0 = _context[\"catch\"](0);\n                alert(_context.t0);\n                this.setState({\n                  loading: false\n                });\n\n              case 17:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 13]]);\n      }));\n\n      function login(_x) {\n        return _login.apply(this, arguments);\n      }\n\n      return login;\n    }()\n  }, {\n    key: \"create\",\n    value: function () {\n      var _create = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(event) {\n        var accounts, addr, _addr;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n                event.preventDefault();\n                this.setState({\n                  loading2: true\n                });\n                _context2.next = 5;\n                return web3.eth.getAccounts();\n\n              case 5:\n                accounts = _context2.sent;\n                _context2.next = 8;\n                return factory.methods.return_addr(accounts[0]).call();\n\n              case 8:\n                addr = _context2.sent;\n\n                if (!(addr != null)) {\n                  _context2.next = 13;\n                  break;\n                }\n\n                Router.pushRoute(\"/home/\".concat(addr));\n                _context2.next = 20;\n                break;\n\n              case 13:\n                _context2.next = 15;\n                return factory.methods.create_mailbox().send({\n                  from: accounts[0]\n                });\n\n              case 15:\n                _context2.next = 17;\n                return factory.methods.return_addr(accounts[0]).call();\n\n              case 17:\n                _addr = _context2.sent;\n                if (_addr != null) Router.pushRoute(\"/home/\".concat(_addr));else alert(\"somthing wrong please try again!\");\n                this.setState({\n                  loading2: false\n                });\n\n              case 20:\n                _context2.next = 26;\n                break;\n\n              case 22:\n                _context2.prev = 22;\n                _context2.t0 = _context2[\"catch\"](0);\n                alert(_context2.t0);\n                this.setState({\n                  loading2: false\n                });\n\n              case 26:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[0, 22]]);\n      }));\n\n      function create(_x2) {\n        return _create.apply(this, arguments);\n      }\n\n      return create;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      return __jsx(React.Fragment, null, __jsx(\"link\", {\n        rel: \"stylesheet\",\n        href: \"https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css\",\n        integrity: \"sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk\",\n        crossOrigin: \"anonymous\"\n      }), __jsx(Container, null, __jsx(Navbar, {\n        bg: \"dark\",\n        variant: \"dark\",\n        style: {\n          width: \"100%\"\n        }\n      }, __jsx(Navbar.Brand, null, __jsx(Link, {\n        route: \"/vote\"\n      }, __jsx(\"a\", {\n        style: {\n          color: \"white\",\n          width: \"100px\"\n        }\n      }, \"Vote\"))), __jsx(Nav, {\n        className: \"mr-auto\",\n        style: {\n          width: \"50%\"\n        }\n      }, __jsx(Link, {\n        route: \"/status\"\n      }, __jsx(\"a\", {\n        style: {\n          color: \"white\",\n          width: \"100px\"\n        }\n      }, \"Status\")), __jsx(Link, {\n        route: \"/admin\"\n      }, __jsx(\"a\", {\n        style: {\n          color: \"white\",\n          width: \"100px\"\n        }\n      }, \"CreateVote\")), __jsx(Link, {\n        route: \"/home\"\n      }, __jsx(\"a\", {\n        style: {\n          color: \"white\",\n          width: \"100px\"\n        }\n      }, \"home\")))), __jsx(\"div\", {\n        style: {\n          margin: \"auto\"\n        }\n      }, __jsx(\"h2\", {\n        style: {\n          margin: \"auto\",\n          marginTop: \"30%\"\n        }\n      }, \"Login to your mailbox\", __jsx(Button, {\n        variant: \"outline-info\",\n        style: {\n          width: '75%',\n          margin: \"auto\",\n          marginTop: \"3%\"\n        },\n        onClick: this.login,\n        loading: this.state.loading.toString()\n      }, \"Login to your mailbox\")), __jsx(\"h2\", {\n        style: {\n          margin: \"auto\",\n          marginTop: \"30%\"\n        }\n      }, \"Create your new mailbox\", __jsx(Button, {\n        variant: \"outline-info\",\n        style: {\n          width: '75%',\n          margin: \"auto\",\n          marginTop: \"3%\"\n        },\n        onClick: this.create,\n        loading: this.state.loading2.toString()\n      }, \"Create new mailbox\")))));\n    }\n  }]);\n\n  return Index;\n}(Component);\n\nexport default Index;","map":{"version":3,"sources":["/Users/suvincent/vote-web/pages/index.js"],"names":["React","Component","Link","Navbar","Nav","Container","Form","FormControl","Button","Card","Table","factory","web3","Router","Index","props","loading","loading2","errorMessage","state","login","bind","create","event","preventDefault","setState","eth","getAccounts","accounts","methods","return_addr","call","addr","pushRoute","alert","create_mailbox","send","from","width","color","margin","marginTop","toString"],"mappings":";;;;;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAAOC,IAAP,QAAiB,WAAjB;AAEA,OAAOC,MAAP,MAAmB,wBAAnB;AACA,OAAOC,GAAP,MAAgB,qBAAhB;AACA,OAAOC,SAAP,MAAsB,qBAAtB;AACA,OAAOC,IAAP,MAAiB,sBAAjB;AACA,OAAOC,WAAP,MAAwB,6BAAxB;AACA,OAAOC,MAAP,MAAmB,wBAAnB;AACA,SAAQC,IAAR,EAAaC,KAAb,QAAyB,iBAAzB;AACA,OAAOC,OAAP,MAAoB,qBAApB;AACA,OAAOC,IAAP,MAAiB,kBAAjB;AACA,SAAQC,MAAR,QAAoB,WAApB;;IACMC,K;;;;;AAMF,iBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,8BAAMA,KAAN;;AADiB,4DALV;AACLC,MAAAA,OAAO,EAAG,KADL;AAELC,MAAAA,QAAQ,EAAE,KAFL;AAGLC,MAAAA,YAAY,EAAC;AAHR,KAKU;;AAEjB,UAAKC,KAAL,GAAY;AACVH,MAAAA,OAAO,EAAG,KADA;AAEVC,MAAAA,QAAQ,EAAE,KAFA;AAGVC,MAAAA,YAAY,EAAC;AAHH,KAAZ,CAFiB,CAOjB;;AACA,UAAKE,KAAL,GAAa,MAAKA,KAAL,CAAWC,IAAX,+BAAb;AACA,UAAKC,MAAL,GAAa,MAAKA,MAAL,CAAYD,IAAZ,+BAAb;AATiB;AAUlB;;;;;6FACWE,K;;;;;;;AAERA,gBAAAA,KAAK,CAACC,cAAN;AACA,qBAAKC,QAAL,CAAc;AAACT,kBAAAA,OAAO,EAAC;AAAT,iBAAd;;uBACqBJ,IAAI,CAACc,GAAL,CAASC,WAAT,E;;;AAAjBC,gBAAAA,Q;;uBACcjB,OAAO,CAACkB,OAAR,CAAgBC,WAAhB,CAA4BF,QAAQ,CAAC,CAAD,CAApC,EAAyCG,IAAzC,E;;;AAAZC,gBAAAA,I;AACN,oBAAGA,IAAI,IAAE,IAAT,EAAcnB,MAAM,CAACoB,SAAP,iBAA0BD,IAA1B,GAAd,KACKE,KAAK,CAAC,gCAAD,CAAL;AACL,qBAAKT,QAAL,CAAc;AAACT,kBAAAA,OAAO,EAAC;AAAT,iBAAd;;;;;;;AAGAkB,gBAAAA,KAAK,aAAL;AACA,qBAAKT,QAAL,CAAc;AAACT,kBAAAA,OAAO,EAAC;AAAT,iBAAd;;;;;;;;;;;;;;;;;;;+FAGSO,K;;;;;;;;AAETA,gBAAAA,KAAK,CAACC,cAAN;AACA,qBAAKC,QAAL,CAAc;AAACR,kBAAAA,QAAQ,EAAC;AAAV,iBAAd;;uBACqBL,IAAI,CAACc,GAAL,CAASC,WAAT,E;;;AAAjBC,gBAAAA,Q;;uBACYjB,OAAO,CAACkB,OAAR,CAAgBC,WAAhB,CAA4BF,QAAQ,CAAC,CAAD,CAApC,EAAyCG,IAAzC,E;;;AAAZC,gBAAAA,I;;sBACDA,IAAI,IAAE,I;;;;;AAAKnB,gBAAAA,MAAM,CAACoB,SAAP,iBAA0BD,IAA1B;;;;;;uBAENrB,OAAO,CAACkB,OAAR,CAAgBM,cAAhB,GAAiCC,IAAjC,CAAsC;AAACC,kBAAAA,IAAI,EAACT,QAAQ,CAAC,CAAD;AAAd,iBAAtC,C;;;;uBACUjB,OAAO,CAACkB,OAAR,CAAgBC,WAAhB,CAA4BF,QAAQ,CAAC,CAAD,CAApC,EAAyCG,IAAzC,E;;;AAAZC,gBAAAA,K;AACJ,oBAAGA,KAAI,IAAE,IAAT,EAAcnB,MAAM,CAACoB,SAAP,iBAA0BD,KAA1B,GAAd,KACKE,KAAK,CAAC,kCAAD,CAAL;AACL,qBAAKT,QAAL,CAAc;AAACR,kBAAAA,QAAQ,EAAC;AAAV,iBAAd;;;;;;;;;AAIFiB,gBAAAA,KAAK,cAAL;AACA,qBAAKT,QAAL,CAAc;AAACR,kBAAAA,QAAQ,EAAC;AAAV,iBAAd;;;;;;;;;;;;;;;;;;6BAGK;AACL,aACE,4BACA;AAAM,QAAA,GAAG,EAAC,YAAV;AAAuB,QAAA,IAAI,EAAC,uEAA5B;AAAoG,QAAA,SAAS,EAAC,yEAA9G;AAAwL,QAAA,WAAW,EAAC;AAApM,QADA,EAEA,MAAC,SAAD,QACA,MAAC,MAAD;AAAQ,QAAA,EAAE,EAAC,MAAX;AAAkB,QAAA,OAAO,EAAC,MAA1B;AAAgC,QAAA,KAAK,EAAE;AAACqB,UAAAA,KAAK,EAAC;AAAP;AAAvC,SACG,MAAC,MAAD,CAAQ,KAAR,QAAe,MAAC,IAAD;AAAM,QAAA,KAAK,EAAC;AAAZ,SAAqB;AAAG,QAAA,KAAK,EAAE;AAACC,UAAAA,KAAK,EAAE,OAAR;AAAiBD,UAAAA,KAAK,EAAC;AAAvB;AAAV,gBAArB,CAAf,CADH,EAEI,MAAC,GAAD;AAAK,QAAA,SAAS,EAAC,SAAf;AAAyB,QAAA,KAAK,EAAE;AAACA,UAAAA,KAAK,EAAC;AAAP;AAAhC,SACG,MAAC,IAAD;AAAM,QAAA,KAAK,EAAC;AAAZ,SAAuB;AAAG,QAAA,KAAK,EAAE;AAACC,UAAAA,KAAK,EAAE,OAAR;AAAiBD,UAAAA,KAAK,EAAC;AAAvB;AAAV,kBAAvB,CADH,EAEG,MAAC,IAAD;AAAM,QAAA,KAAK,EAAC;AAAZ,SAAsB;AAAG,QAAA,KAAK,EAAE;AAACC,UAAAA,KAAK,EAAE,OAAR;AAAiBD,UAAAA,KAAK,EAAC;AAAvB;AAAV,sBAAtB,CAFH,EAGG,MAAC,IAAD;AAAM,QAAA,KAAK,EAAC;AAAZ,SAAqB;AAAG,QAAA,KAAK,EAAE;AAACC,UAAAA,KAAK,EAAE,OAAR;AAAiBD,UAAAA,KAAK,EAAC;AAAvB;AAAV,gBAArB,CAHH,CAFJ,CADA,EAUD;AAAK,QAAA,KAAK,EAAE;AAACE,UAAAA,MAAM,EAAC;AAAR;AAAZ,SACC;AAAI,QAAA,KAAK,EAAI;AAACA,UAAAA,MAAM,EAAC,MAAR;AAAeC,UAAAA,SAAS,EAAG;AAA3B;AAAb,kCAEA,MAAC,MAAD;AAAQ,QAAA,OAAO,EAAC,cAAhB;AAA+B,QAAA,KAAK,EAAI;AAACH,UAAAA,KAAK,EAAE,KAAR;AAAcE,UAAAA,MAAM,EAAC,MAArB;AAA4BC,UAAAA,SAAS,EAAG;AAAxC,SAAxC;AAAuF,QAAA,OAAO,EAAE,KAAKrB,KAArG;AAA4G,QAAA,OAAO,EAAE,KAAKD,KAAL,CAAWH,OAAX,CAAmB0B,QAAnB;AAArH,iCAFA,CADD,EAKC;AAAI,QAAA,KAAK,EAAI;AAACF,UAAAA,MAAM,EAAC,MAAR;AAAeC,UAAAA,SAAS,EAAG;AAA3B;AAAb,oCAEA,MAAC,MAAD;AAAQ,QAAA,OAAO,EAAC,cAAhB;AAA+B,QAAA,KAAK,EAAI;AAACH,UAAAA,KAAK,EAAE,KAAR;AAAcE,UAAAA,MAAM,EAAC,MAArB;AAA4BC,UAAAA,SAAS,EAAG;AAAxC,SAAxC;AAAuF,QAAA,OAAO,EAAE,KAAKnB,MAArG;AAA6G,QAAA,OAAO,EAAE,KAAKH,KAAL,CAAWF,QAAX,CAAoByB,QAApB;AAAtH,8BAFA,CALD,CAVC,CAFA,CADF;AA0BH;;;;EA/EezC,S;;AAmFpB,eAAea,KAAf","sourcesContent":["import React, { Component } from 'react';\nimport{Link}from '../routes';\n\nimport Navbar from 'react-bootstrap/Navbar';\nimport Nav from 'react-bootstrap/Nav';\nimport Container from 'react-bootstrap/Nav';\nimport Form from 'react-bootstrap/Form';\nimport FormControl from 'react-bootstrap/FormControl';\nimport Button from 'react-bootstrap/Button';\nimport {Card,Table} from 'react-bootstrap';\nimport factory from '../ethereum/factory';\nimport web3 from '../ethereum/web3'\nimport {Router}from '../routes';\nclass Index extends Component {\n      state ={\n        loading : false,\n        loading2: false,\n        errorMessage:''\n    };\n    constructor(props) {\n      super(props);\n      this.state ={\n        loading : false,\n        loading2: false,\n        errorMessage:''\n    };\n      // 為了讓 `this` 能在 callback 中被使用，這裡的綁定是必要的：\n      this.login = this.login.bind(this);\n      this.create= this.create.bind(this);\n    }\n    async login(event){\n      try{\n        event.preventDefault();\n        this.setState({loading:true});\n        var accounts = await web3.eth.getAccounts();\n        const addr =await factory.methods.return_addr(accounts[0]).call();\n        if(addr!=null)Router.pushRoute(`/home/${addr}`);\n        else alert(\"please create a mailbox first!\")\n        this.setState({loading:false});\n      }\n      catch(err){\n        alert(err);\n        this.setState({loading:false});\n      }\n    }\n    async create(event){\n      try{\n        event.preventDefault();\n        this.setState({loading2:true});\n        var accounts = await web3.eth.getAccounts();\n        let addr =await factory.methods.return_addr(accounts[0]).call();\n        if(addr!=null)Router.pushRoute(`/home/${addr}`);\n        else {\n          await factory.methods.create_mailbox().send({from:accounts[0]});\n          let addr =await factory.methods.return_addr(accounts[0]).call();\n          if(addr!=null)Router.pushRoute(`/home/${addr}`);\n          else alert(\"somthing wrong please try again!\");\n          this.setState({loading2:false});\n        }\n      }\n      catch(err){\n        alert(err);\n        this.setState({loading2:false});\n      }\n    }\n    render() {\n        return(\n          <>\n          <link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css\" integrity=\"sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk\" crossOrigin=\"anonymous\"/>\n          <Container>\n          <Navbar bg=\"dark\" variant=\"dark\"style={{width:\"100%\"}}>\n             <Navbar.Brand ><Link route=\"/vote\" ><a style={{color: \"white\", width:\"100px\"}}>Vote</a></Link></Navbar.Brand>\n              <Nav className=\"mr-auto\" style={{width:\"50%\"}}>\n                 <Link route=\"/status\" ><a style={{color: \"white\", width:\"100px\"}}>Status</a></Link>\n                 <Link route=\"/admin\" ><a style={{color: \"white\", width:\"100px\"}}>CreateVote</a></Link>\n                 <Link route=\"/home\" ><a style={{color: \"white\", width:\"100px\"}}>home</a></Link>\n              </Nav>\n         </Navbar>\n         \n         <div style={{margin:\"auto\"}}>\n          <h2 style = {{margin:\"auto\",marginTop : \"30%\"}}>\n            Login to your mailbox\n          <Button variant=\"outline-info\" style = {{width :'75%',margin:\"auto\",marginTop : \"3%\"}} onClick={this.login} loading={this.state.loading.toString()}>Login to your mailbox</Button>\n          </h2>\n          <h2 style = {{margin:\"auto\",marginTop : \"30%\"}}>\n            Create your new mailbox\n          <Button variant=\"outline-info\" style = {{width :'75%',margin:\"auto\",marginTop : \"3%\"}} onClick={this.create} loading={this.state.loading2.toString()}>Create new mailbox</Button>\n          </h2>\n        </div>\n       </Container>\n         </>\n    )\n    }\n}\n\n\nexport default Index;"]},"metadata":{},"sourceType":"module"}