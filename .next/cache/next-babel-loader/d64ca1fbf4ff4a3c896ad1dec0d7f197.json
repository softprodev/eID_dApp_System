{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { Component } from 'react';\nimport { Link } from '../../routes';\nimport Navbar from 'react-bootstrap/Navbar';\nimport Nav from 'react-bootstrap/Nav';\nimport Container from 'react-bootstrap/Nav';\nimport Form from 'react-bootstrap/Form';\nimport FormControl from 'react-bootstrap/FormControl';\nimport Button from 'react-bootstrap/Button';\nimport { Card, Table } from 'react-bootstrap';\nimport factory from '../../ethereum/Vote/factory';\nimport web3 from '../../ethereum/web3';\nimport { Router } from '../../routes';\n\nclass Index extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: false,\n      loading2: false,\n      errorMessage: ''\n    }; // 為了讓 `this` 能在 callback 中被使用，這裡的綁定是必要的：\n\n    this.login = this.login.bind(this);\n    this.create = this.create.bind(this);\n  }\n\n  async login(event) {\n    try {\n      event.preventDefault();\n      this.setState({\n        loading: true\n      });\n      const accounts = await web3.eth.getAccounts();\n      console.log(accounts[0]);\n      const addr = await factory.methods.return_addr(accounts[0]).call();\n      console.log(addr);\n      if (addr != '0x0000000000000000000000000000000000000000') Router.pushRoute(`/home/${addr.toString()}`);else alert(\"please create a mailbox first!\");\n      this.setState({\n        loading: false\n      });\n    } catch (err) {\n      alert(err);\n      this.setState({\n        loading: false\n      });\n    }\n  }\n\n  async create(event) {\n    try {\n      event.preventDefault();\n      this.setState({\n        loading2: true\n      });\n      var accounts = await web3.eth.getAccounts();\n      let addr = await factory.methods.return_addr(accounts[0]).call();\n      if (addr != '0x0000000000000000000000000000000000000000') Router.pushRoute(`/home/${addr}`);else {\n        await factory.methods.create_mailbox().send({\n          from: accounts[0]\n        });\n        let addr = await factory.methods.return_addr(accounts[0]).call();\n        if (addr != null) Router.pushRoute(`/home/${addr}`);else alert(\"somthing wrong please try again!\");\n        this.setState({\n          loading2: false\n        });\n      }\n    } catch (err) {\n      alert(err);\n      this.setState({\n        loading2: false\n      });\n    }\n  }\n\n  render() {\n    return __jsx(React.Fragment, null, __jsx(\"link\", {\n      rel: \"stylesheet\",\n      href: \"https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css\",\n      integrity: \"sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk\",\n      crossOrigin: \"anonymous\"\n    }), __jsx(Container, null, __jsx(Navbar, {\n      bg: \"dark\",\n      variant: \"dark\",\n      style: {\n        width: \"100%\"\n      }\n    }, __jsx(Navbar.Brand, null, __jsx(Link, {\n      route: \"/vote/0x4CbCE152A771B089d1d82DccCA01253430194b10\"\n    }, __jsx(\"a\", {\n      style: {\n        color: \"white\",\n        width: \"100px\"\n      }\n    }, \"Vote\"))), __jsx(Nav, {\n      className: \"mr-auto\",\n      style: {\n        width: \"50%\",\n        color: \"white\"\n      }\n    }, \"Welcome to the vote website!\")), __jsx(\"div\", {\n      style: {\n        margin: \"auto\"\n      }\n    }, __jsx(\"h2\", {\n      style: {\n        margin: \"auto\",\n        marginTop: \"30%\"\n      }\n    }, \"Login to your mailbox\", __jsx(Button, {\n      variant: \"outline-info\",\n      style: {\n        width: '75%',\n        margin: \"auto\",\n        marginTop: \"3%\"\n      },\n      onClick: this.login,\n      loading: this.state.loading.toString()\n    }, \"Login to your mailbox\")), __jsx(\"h2\", {\n      style: {\n        margin: \"auto\",\n        marginTop: \"30%\"\n      }\n    }, \"Create your new mailbox\", __jsx(Button, {\n      variant: \"outline-info\",\n      style: {\n        width: '75%',\n        margin: \"auto\",\n        marginTop: \"3%\"\n      },\n      onClick: this.create,\n      loading: this.state.loading2.toString()\n    }, \"Create new mailbox\")))));\n  }\n\n}\n\nexport default Index;","map":{"version":3,"sources":["C:/Users/user/Desktop/college/Blockchain/DApp/nextjs-web/pages/Vote/index.js"],"names":["React","Component","Link","Navbar","Nav","Container","Form","FormControl","Button","Card","Table","factory","web3","Router","Index","constructor","props","state","loading","loading2","errorMessage","login","bind","create","event","preventDefault","setState","accounts","eth","getAccounts","console","log","addr","methods","return_addr","call","pushRoute","toString","alert","err","create_mailbox","send","from","render","width","color","margin","marginTop"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport{Link}from '../../routes';\r\n\r\nimport Navbar from 'react-bootstrap/Navbar';\r\nimport Nav from 'react-bootstrap/Nav';\r\nimport Container from 'react-bootstrap/Nav';\r\nimport Form from 'react-bootstrap/Form';\r\nimport FormControl from 'react-bootstrap/FormControl';\r\nimport Button from 'react-bootstrap/Button';\r\nimport {Card,Table} from 'react-bootstrap';\r\nimport factory from '../../ethereum/Vote/factory';\r\nimport web3 from '../../ethereum/web3'\r\nimport {Router}from '../../routes';\r\nclass Index extends Component {\r\n    constructor(props) {\r\n      super(props);\r\n      this.state ={\r\n        loading : false,\r\n        loading2: false,\r\n        errorMessage:''\r\n    };\r\n      // 為了讓 `this` 能在 callback 中被使用，這裡的綁定是必要的：\r\n      this.login = this.login.bind(this);\r\n      this.create= this.create.bind(this);\r\n    }\r\n    async login(event){\r\n      try{\r\n        event.preventDefault();\r\n        this.setState({loading:true});\r\n        const accounts = await web3.eth.getAccounts();\r\n        console.log(accounts[0]);\r\n        const addr =await factory.methods.return_addr(accounts[0]).call();\r\n        console.log(addr);\r\n        if(addr!='0x0000000000000000000000000000000000000000')Router.pushRoute(`/home/${addr.toString()}`);\r\n        else alert(\"please create a mailbox first!\")\r\n        this.setState({loading:false});\r\n      }\r\n      catch(err){\r\n        alert(err);\r\n        this.setState({loading:false});\r\n      }\r\n    }\r\n    async create(event){\r\n      try{\r\n        event.preventDefault();\r\n        this.setState({loading2:true});\r\n        var accounts = await web3.eth.getAccounts();\r\n        let addr =await factory.methods.return_addr(accounts[0]).call();\r\n        if(addr!='0x0000000000000000000000000000000000000000')Router.pushRoute(`/home/${addr}`);\r\n        else {\r\n          await factory.methods.create_mailbox().send({from:accounts[0]});\r\n          let addr =await factory.methods.return_addr(accounts[0]).call();\r\n          if(addr!=null)Router.pushRoute(`/home/${addr}`);\r\n          else alert(\"somthing wrong please try again!\");\r\n          this.setState({loading2:false});\r\n        }\r\n      }\r\n      catch(err){\r\n        alert(err);\r\n        this.setState({loading2:false});\r\n      }\r\n    }\r\n    render() {\r\n        return(\r\n          <>\r\n          <link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css\" integrity=\"sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk\" crossOrigin=\"anonymous\"/>\r\n          <Container>\r\n          <Navbar bg=\"dark\" variant=\"dark\"style={{width:\"100%\"}}>\r\n             <Navbar.Brand ><Link route=\"/vote/0x4CbCE152A771B089d1d82DccCA01253430194b10\" ><a style={{color: \"white\", width:\"100px\"}}>Vote</a></Link></Navbar.Brand>\r\n              <Nav className=\"mr-auto\" style={{width:\"50%\" ,color:\"white\"}}>\r\n                 Welcome to the vote website!\r\n              </Nav>\r\n         </Navbar>\r\n         \r\n         <div style={{margin:\"auto\"}}>\r\n          <h2 style = {{margin:\"auto\",marginTop : \"30%\"}}>\r\n            Login to your mailbox\r\n          <Button variant=\"outline-info\" style = {{width :'75%',margin:\"auto\",marginTop : \"3%\"}} onClick={this.login} loading={this.state.loading.toString()}>Login to your mailbox</Button>\r\n          </h2>\r\n          <h2 style = {{margin:\"auto\",marginTop : \"30%\"}}>\r\n            Create your new mailbox\r\n          <Button variant=\"outline-info\" style = {{width :'75%',margin:\"auto\",marginTop : \"3%\"}} onClick={this.create} loading={this.state.loading2.toString()}>Create new mailbox</Button>\r\n          </h2>\r\n        </div>\r\n       </Container>\r\n         </>\r\n    )\r\n    }\r\n}\r\n\r\n\r\nexport default Index;"]},"metadata":{},"sourceType":"module"}