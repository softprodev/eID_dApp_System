{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\n//做一個頁面是沒有mailbox時要新增一個mailbox\nimport React, { Component } from 'react';\nimport { Link } from '../../routes';\nimport Navbar from 'react-bootstrap/Navbar';\nimport Nav from 'react-bootstrap/Nav';\nimport Container from 'react-bootstrap/Nav';\nimport Form from 'react-bootstrap/Form';\nimport FormControl from 'react-bootstrap/FormControl';\nimport Button from 'react-bootstrap/Button';\nimport { Card, Table } from 'react-bootstrap';\nimport web3 from '../../ethereum/web3';\nimport { Router } from '../../routes';\nimport mailbox from '../../ethereum/Vote/mailbox';\nimport vote from '../../ethereum/Vote/vote'; //const header = [\"#\", \"vote name\", \"vote address\", \"due date\", \"link\"];\n\nvar Join = /*#__PURE__*/function (_Component) {\n  _inherits(Join, _Component);\n\n  var _super = _createSuper(Join);\n\n  function Join() {\n    _classCallCheck(this, Join);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(Join, [{\n    key: \"render\",\n    //{this.props.joins.map(item => <td>{item}</td>)}\n    value: function render() {\n      return __jsx(React.Fragment, null, __jsx(\"td\", null, this.props.joins[0]), __jsx(\"td\", null, this.props.joins[1]), __jsx(\"td\", null, __jsx(Link, {\n        route: \"/Vote/vote/\" + this.props.mb_addr + \"/\" + this.props.joins[2]\n      }, __jsx(\"a\", null, this.props.joins[2]))), __jsx(\"td\", null, this.props.joins[3]), __jsx(\"td\", null, __jsx(Link, {\n        route: \"/Vote/status/\" + this.props.mb_addr + \"/\" + this.props.joins[4]\n      }, __jsx(\"a\", null, \"link\"))));\n    }\n  }]);\n\n  return Join;\n}(Component);\n\nvar Join_list = /*#__PURE__*/function (_Component2) {\n  _inherits(Join_list, _Component2);\n\n  var _super2 = _createSuper(Join_list);\n\n  function Join_list() {\n    _classCallCheck(this, Join_list);\n\n    return _super2.apply(this, arguments);\n  }\n\n  _createClass(Join_list, [{\n    key: \"render\",\n    //const vote_btn =function (stage ){\n    value: function render() {\n      var _this = this;\n\n      return __jsx(React.Fragment, null, this.props.list.map(function (key) {\n        return __jsx(\"tr\", null, __jsx(Join, {\n          joins: key,\n          mb_addr: _this.props.mb_addr\n        }));\n      }));\n    }\n  }]);\n\n  return Join_list;\n}(Component);\n\n;\n\nvar Self = /*#__PURE__*/function (_Component3) {\n  _inherits(Self, _Component3);\n\n  var _super3 = _createSuper(Self);\n\n  //{this.props.joins.map(item => <td>{item}</td>)}\n  function Self(props) {\n    var _this2;\n\n    _classCallCheck(this, Self);\n\n    _this2 = _super3.call(this, props);\n    _this2.next = _this2.next.bind(_assertThisInitialized(_this2));\n    return _this2;\n  }\n\n  _createClass(Self, [{\n    key: \"next\",\n    value: function () {\n      var _next = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var current_stage, v_address, accounts, Vote_event;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                current_stage = this.props.selfs[4];\n                v_address = this.props.selfs[2];\n                _context.next = 4;\n                return web3.eth.getAccounts();\n\n              case 4:\n                accounts = _context.sent;\n                _context.next = 7;\n                return vote(v_address);\n\n              case 7:\n                Vote_event = _context.sent;\n\n                if (!(current_stage == 0)) {\n                  _context.next = 20;\n                  break;\n                }\n\n                _context.prev = 9;\n                _context.next = 12;\n                return Vote_event.methods.set_can_register().send({\n                  from: accounts[0]\n                });\n\n              case 12:\n                Router.pushRoute(\"/Vote/home/\".concat(this.props.mb_addr));\n                _context.next = 18;\n                break;\n\n              case 15:\n                _context.prev = 15;\n                _context.t0 = _context[\"catch\"](9);\n                alert(_context.t0);\n\n              case 18:\n                _context.next = 45;\n                break;\n\n              case 20:\n                if (!(current_stage == 1)) {\n                  _context.next = 32;\n                  break;\n                }\n\n                _context.prev = 21;\n                _context.next = 24;\n                return Vote_event.methods.set_can_vote().send({\n                  from: accounts[0]\n                });\n\n              case 24:\n                Router.pushRoute(\"/Vote/home/\".concat(this.props.mb_addr));\n                _context.next = 30;\n                break;\n\n              case 27:\n                _context.prev = 27;\n                _context.t1 = _context[\"catch\"](21);\n                alert(_context.t1);\n\n              case 30:\n                _context.next = 45;\n                break;\n\n              case 32:\n                if (!(current_stage == 2)) {\n                  _context.next = 44;\n                  break;\n                }\n\n                _context.prev = 33;\n                _context.next = 36;\n                return Vote_event.methods.set_can_tally().send({\n                  from: accounts[0]\n                });\n\n              case 36:\n                Router.pushRoute(\"/Vote/home/\".concat(this.props.mb_addr));\n                _context.next = 42;\n                break;\n\n              case 39:\n                _context.prev = 39;\n                _context.t2 = _context[\"catch\"](33);\n                alert(_context.t2);\n\n              case 42:\n                _context.next = 45;\n                break;\n\n              case 44:\n                //tally and finish\n                alert(\"current stage don't need other setting\");\n\n              case 45:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[9, 15], [21, 27], [33, 39]]);\n      }));\n\n      function next() {\n        return _next.apply(this, arguments);\n      }\n\n      return next;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      return __jsx(React.Fragment, null, __jsx(\"td\", null, self), __jsx(\"td\", null, this.props.selfs[1]), __jsx(\"td\", null, __jsx(Link, {\n        route: \"/Vote/vote/\" + this.props.mb_addr + \"/\" + this.props.selfs[2]\n      }, __jsx(\"a\", null, this.props.selfs[2]))), __jsx(\"td\", null, this.props.selfs[3]), __jsx(\"td\", null, __jsx(Button, {\n        variant: \"primary\",\n        onClick: this.next\n      }, this.props.selfs[4] == 0 ? \"Set Register\" : this.props.selfs[4] == 1 ? \"Set Vote\" : this.props.selfs[4] == 2 ? \"Set Tally\" : this.props.selfs[4] == 3 ? \"Setting finish\" : \"Finish\")), __jsx(\"td\", null, __jsx(Link, {\n        route: \"/Vote/status/\" + this.props.mb_addr + \"/\" + this.props.selfs[2]\n      }, __jsx(\"a\", null, \"link\"))), __jsx(\"td\", null, __jsx(Link, {\n        route: \"/Vote/admin/\" + this.props.mb_addr + \"/\" + this.props.selfs[2]\n      }, __jsx(\"a\", null, \"link\"))));\n    }\n  }]);\n\n  return Self;\n}(Component);\n\nvar Self_list = /*#__PURE__*/function (_Component4) {\n  _inherits(Self_list, _Component4);\n\n  var _super4 = _createSuper(Self_list);\n\n  function Self_list() {\n    _classCallCheck(this, Self_list);\n\n    return _super4.apply(this, arguments);\n  }\n\n  _createClass(Self_list, [{\n    key: \"render\",\n    //const vote_btn =function (stage ){\n    value: function render() {\n      var _this3 = this;\n\n      return __jsx(React.Fragment, null, this.props.list.map(function (self) {\n        return __jsx(\"tr\", null, __jsx(Self, {\n          key: self.id,\n          mb_addr: _this3.props.mb_addr\n        }));\n      }));\n    }\n  }]);\n\n  return Self_list;\n}(Component);\n\n;\n\nvar Home = /*#__PURE__*/function (_Component5) {\n  _inherits(Home, _Component5);\n\n  var _super5 = _createSuper(Home);\n\n  function Home(props) {\n    var _this4;\n\n    _classCallCheck(this, Home);\n\n    _this4 = _super5.call(this, props);\n    _this4.state = {\n      // Mb_addr :props.query.address,\n      search: \"\",\n      addr: \"\",\n      loading: false,\n      loading2: false,\n      errorMessage: ''\n    };\n    _this4.refresh_search = _this4.refresh_search.bind(_assertThisInitialized(_this4));\n    _this4.create_vote = _this4.create_vote.bind(_assertThisInitialized(_this4));\n    _this4.add_list = _this4.add_list.bind(_assertThisInitialized(_this4));\n    return _this4;\n  }\n\n  _createClass(Home, [{\n    key: \"refresh_search\",\n    value: function refresh_search() {\n      if (this.state.search != \"\") Router.pushRoute(\"/Vote/vote/\".concat(this.props.mb_addr, \"/\").concat(this.state.search)); //console.log(this.props.address);\n    }\n  }, {\n    key: \"create_vote\",\n    value: function () {\n      var _create_vote = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        var accounts, Mailbox;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return web3.eth.getAccounts();\n\n              case 2:\n                accounts = _context2.sent;\n                _context2.next = 5;\n                return mailbox(this.props.mb_addr);\n\n              case 5:\n                Mailbox = _context2.sent;\n                _context2.prev = 6;\n                _context2.next = 9;\n                return Mailbox.methods.create_vote().send({\n                  from: accounts[0]\n                });\n\n              case 9:\n                Router.pushRoute(\"/Vote/home/\".concat(this.props.mb_addr));\n                _context2.next = 15;\n                break;\n\n              case 12:\n                _context2.prev = 12;\n                _context2.t0 = _context2[\"catch\"](6);\n                alert(_context2.t0);\n\n              case 15:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[6, 12]]);\n      }));\n\n      function create_vote() {\n        return _create_vote.apply(this, arguments);\n      }\n\n      return create_vote;\n    }()\n  }, {\n    key: \"add_list\",\n    value: function () {\n      var _add_list = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        var accounts, Mailbox;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return web3.eth.getAccounts();\n\n              case 2:\n                accounts = _context3.sent;\n                _context3.next = 5;\n                return mailbox(this.props.mb_addr);\n\n              case 5:\n                Mailbox = _context3.sent;\n                _context3.prev = 6;\n                _context3.next = 9;\n                return Mailbox.methods.add_to_join_list(this.state.addr).send({\n                  from: accounts[0]\n                });\n\n              case 9:\n                Router.pushRoute(\"/Vote/home/\".concat(this.props.mb_addr));\n                _context3.next = 15;\n                break;\n\n              case 12:\n                _context3.prev = 12;\n                _context3.t0 = _context3[\"catch\"](6);\n                alert(_context3.t0);\n\n              case 15:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this, [[6, 12]]);\n      }));\n\n      function add_list() {\n        return _add_list.apply(this, arguments);\n      }\n\n      return add_list;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this5 = this;\n\n      return __jsx(React.Fragment, null, __jsx(\"link\", {\n        rel: \"stylesheet\",\n        href: \"https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css\",\n        integrity: \"sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk\",\n        crossOrigin: \"anonymous\"\n      }), __jsx(Container, null, __jsx(Navbar, {\n        bg: \"dark\",\n        variant: \"dark\",\n        style: {\n          width: \"100%\"\n        }\n      }, __jsx(Navbar.Brand, null, \"Vote\"), __jsx(Nav, {\n        className: \"mr-auto\",\n        style: {\n          width: \"50%\"\n        }\n      }, __jsx(Link, {\n        route: \"/Vote/index\"\n      }, __jsx(\"a\", {\n        style: {\n          color: \"white\",\n          width: \"100px\"\n        }\n      }, \"Logout\"))), __jsx(Form, {\n        inline: true\n      }, __jsx(\"div\", {\n        style: {\n          color: \"white\"\n        }\n      }, \" inesrt your vote contract address here  ->   \"), __jsx(FormControl, {\n        type: \"text\",\n        placeholder: \"Search\",\n        className: \"mr-sm-2\",\n        value: this.state.search,\n        onChange: function onChange(event) {\n          return _this5.setState({\n            search: event.target.value\n          });\n        }\n      }), __jsx(Button, {\n        variant: \"outline-info\",\n        onClick: this.refresh_search\n      }, \"Search\"))), __jsx(\"div\", {\n        style: {\n          width: '100%'\n        }\n      }, __jsx(\"h2\", {\n        style: {\n          width: '75%',\n          margin: \"auto\",\n          marginTop: \"3%\"\n        }\n      }, \"Vote List (the vote you are invited)\", __jsx(Form, {\n        inline: true\n      }, __jsx(\"h4\", null, \" add vote contract address to list  ->   \"), __jsx(FormControl, {\n        type: \"text\",\n        placeholder: \"add\",\n        className: \"mr-sm-2\",\n        value: this.state.addr,\n        onChange: function onChange(event) {\n          return _this5.setState({\n            addr: event.target.value\n          });\n        }\n      }), __jsx(Button, {\n        variant: \"primary\",\n        onClick: this.add_list\n      }, \"Add\"))), __jsx(Table, {\n        striped: true,\n        bordered: true,\n        hover: true,\n        size: \"sm\",\n        style: {\n          width: '75%',\n          margin: \"auto\",\n          marginTop: \"3%\"\n        }\n      }, __jsx(\"thead\", null, __jsx(\"tr\", null, __jsx(\"th\", null, \"#\"), __jsx(\"th\", null, \"vote name\"), __jsx(\"th\", null, \"vote address\"), __jsx(\"th\", null, \"due date\"), __jsx(\"th\", null, \"status\"))), __jsx(\"tbody\", null, __jsx(Join_list, {\n        list: this.props.join_detail,\n        mb_addr: this.props.mb_addr\n      })))), __jsx(\"div\", {\n        style: {\n          width: '100%'\n        }\n      }, __jsx(\"h2\", {\n        style: {\n          width: '75%',\n          margin: \"auto\",\n          marginTop: \"3%\"\n        }\n      }, \"Vote Admin List (the vote you create)\", __jsx(Button, {\n        variant: \"primary\",\n        onClick: this.create_vote\n      }, \"create new vote\")), __jsx(Table, {\n        striped: true,\n        bordered: true,\n        hover: true,\n        size: \"sm\",\n        style: {\n          width: '75%',\n          margin: \"auto\",\n          marginTop: \"3%\"\n        }\n      }, __jsx(\"thead\", null, __jsx(\"tr\", null, __jsx(\"th\", null, \"#\"), __jsx(\"th\", null, \"vote name\"), __jsx(\"th\", null, \"vote address\"), __jsx(\"th\", null, \"next step due date\"), __jsx(\"th\", null, \"nextstep\"), __jsx(\"th\", null, \"status\"), __jsx(\"th\", null, \"set question\"))), __jsx(\"tbody\", null, __jsx(Self_list, {\n        list: this.props.self_detail,\n        mb_addr: this.props.mb_addr\n      }))))));\n    }\n  }], [{\n    key: \"getInitialProps\",\n    value: function () {\n      var _getInitialProps = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(props) {\n        var mb_addr, Mailbox, join, join_detail, index, arr, v_addr, v, self, self_detail, _index, _arr, _v_addr, _v;\n\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                //const{mbaddr} = props.query;\n                mb_addr = props.query.mb_addr; //const accounts = await web3.eth.getAccounts();\n\n                Mailbox = mailbox(mb_addr);\n                console.log(mb_addr);\n                _context4.next = 5;\n                return Mailbox.methods.return_join_list().call();\n\n              case 5:\n                join = _context4.sent;\n                //console.log(join);\n                //console.log(join.length);\n                join_detail = [];\n                index = 0;\n\n              case 8:\n                if (!(index < join.length)) {\n                  _context4.next = 23;\n                  break;\n                }\n\n                arr = [];\n                v_addr = join[index];\n                v = vote(v_addr);\n                arr[0] = (index + 1).toString();\n                _context4.next = 15;\n                return v.methods.return_question().call();\n\n              case 15:\n                arr[1] = _context4.sent;\n                arr[2] = v_addr; //let t = await v.methods.return_time().call();\n                //console.log(t);\n\n                arr[3] = \"today\";\n                arr[4] = v_addr;\n                join_detail[index] = arr;\n\n              case 20:\n                index++;\n                _context4.next = 8;\n                break;\n\n              case 23:\n                _context4.next = 25;\n                return Mailbox.methods.return_self_list().call();\n\n              case 25:\n                self = _context4.sent;\n                self_detail = [];\n                _index = 0;\n\n              case 28:\n                if (!(_index < self.length)) {\n                  _context4.next = 45;\n                  break;\n                }\n\n                _arr = [];\n                _v_addr = self[_index];\n                _v = vote(_v_addr);\n                _arr[0] = (_index + 1).toString();\n                _context4.next = 35;\n                return _v.methods.return_question().call();\n\n              case 35:\n                _arr[1] = _context4.sent;\n                _arr[2] = _v_addr; //arr[3] = await v.methods.return_time().call();\n\n                _arr[3] = \"today\";\n                _context4.next = 40;\n                return _v.methods.return_stage().call();\n\n              case 40:\n                _arr[4] = _context4.sent;\n                //return stage 之後要set stage\n                self_detail[_index] = _arr;\n\n              case 42:\n                _index++;\n                _context4.next = 28;\n                break;\n\n              case 45:\n                console.log(self); //console.log(join_detail);\n\n                return _context4.abrupt(\"return\", {\n                  mb_addr: mb_addr,\n                  join_detail: join_detail,\n                  self_detail: self_detail\n                });\n\n              case 47:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4);\n      }));\n\n      function getInitialProps(_x) {\n        return _getInitialProps.apply(this, arguments);\n      }\n\n      return getInitialProps;\n    }()\n  }]);\n\n  return Home;\n}(Component);\n\nexport default Home;","map":{"version":3,"sources":["C:/Users/suvin/vincent/Dapp/nextjs-web/pages/Vote/home.js"],"names":["React","Component","Link","Navbar","Nav","Container","Form","FormControl","Button","Card","Table","web3","Router","mailbox","vote","Join","props","joins","mb_addr","Join_list","list","map","key","Self","next","bind","current_stage","selfs","v_address","eth","getAccounts","accounts","Vote_event","methods","set_can_register","send","from","pushRoute","alert","set_can_vote","set_can_tally","self","Self_list","id","Home","state","search","addr","loading","loading2","errorMessage","refresh_search","create_vote","add_list","Mailbox","add_to_join_list","width","color","event","setState","target","value","margin","marginTop","join_detail","self_detail","query","console","log","return_join_list","call","join","index","length","arr","v_addr","v","toString","return_question","return_self_list","return_stage"],"mappings":"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","sourcesContent":["//做一個頁面是沒有mailbox時要新增一個mailbox\r\nimport React, { Component } from 'react';\r\nimport{Link}from '../../routes';\r\n\r\nimport Navbar from 'react-bootstrap/Navbar';\r\nimport Nav from 'react-bootstrap/Nav';\r\nimport Container from 'react-bootstrap/Nav';\r\nimport Form from 'react-bootstrap/Form';\r\nimport FormControl from 'react-bootstrap/FormControl';\r\nimport Button from 'react-bootstrap/Button';\r\nimport {Card,Table} from 'react-bootstrap';\r\n\r\nimport web3 from '../../ethereum/web3'\r\nimport {Router}from '../../routes';\r\nimport mailbox from '../../ethereum/Vote/mailbox';\r\nimport vote from '../../ethereum/Vote/vote';\r\n//const header = [\"#\", \"vote name\", \"vote address\", \"due date\", \"link\"];\r\nclass Join extends Component {\r\n  //{this.props.joins.map(item => <td>{item}</td>)}\r\n    render(){\r\n      return (\r\n        <>\r\n          <td>{this.props.joins[0]}</td>\r\n          <td>{this.props.joins[1]}</td>\r\n          <td><Link route={\"/Vote/vote/\"+this.props.mb_addr+\"/\"+this.props.joins[2]} ><a>{this.props.joins[2]}</a></Link></td>\r\n          <td>{this.props.joins[3]}</td>\r\n          <td><Link route={\"/Vote/status/\"+this.props.mb_addr+\"/\"+this.props.joins[4]} ><a>link</a></Link></td>\r\n        </>\r\n      );\r\n    }\r\n}\r\nclass Join_list extends Component{\r\n  //const vote_btn =function (stage ){\r\n      render(){\r\n      return (\r\n          <>\r\n          {this.props.list.map(key => <tr><Join joins={key} mb_addr={this.props.mb_addr}></Join></tr>)}\r\n          </>\r\n      );\r\n      }\r\n};\r\nclass Self extends Component {\r\n  //{this.props.joins.map(item => <td>{item}</td>)}\r\n      constructor(props) {\r\n        super(props);\r\n        this.next = this.next.bind(this);\r\n      }\r\n      async next(){\r\n        const current_stage = this.props.selfs[4];\r\n        const v_address = this.props.selfs[2];\r\n        const accounts = await web3.eth.getAccounts();\r\n        const Vote_event =await vote(v_address);\r\n        if(current_stage == 0){//set up\r\n          try{\r\n          await Vote_event.methods.set_can_register().send({from:accounts[0]});\r\n            Router.pushRoute(`/Vote/home/${this.props.mb_addr}`);\r\n          }\r\n          catch(err){\r\n            alert(err);\r\n          }\r\n        }\r\n        else if(current_stage == 1){//registry\r\n          try{\r\n            await Vote_event.methods.set_can_vote().send({from:accounts[0]});\r\n              Router.pushRoute(`/Vote/home/${this.props.mb_addr}`);\r\n            }\r\n            catch(err){\r\n              alert(err);\r\n            }\r\n        }\r\n        else if(current_stage == 2){//vote\r\n          try{\r\n            await Vote_event.methods.set_can_tally().send({from:accounts[0]});\r\n              Router.pushRoute(`/Vote/home/${this.props.mb_addr}`);\r\n            }\r\n            catch(err){\r\n              alert(err);\r\n            }\r\n        }\r\n        else {//tally and finish\r\n          alert(\"current stage don't need other setting\")\r\n        }\r\n        \r\n      }\r\n    render(){\r\n      return (\r\n        <>  \r\n          <td>{self}</td>\r\n          <td>{this.props.selfs[1]}</td>\r\n          <td><Link route={\"/Vote/vote/\"+this.props.mb_addr+\"/\"+this.props.selfs[2]} ><a>{this.props.selfs[2]}</a></Link></td>\r\n          <td>{this.props.selfs[3]}</td>\r\n          <td><Button variant=\"primary\" \r\n            onClick={this.next}>\r\n              {(this.props.selfs[4] == 0)?\"Set Register\":\r\n               (this.props.selfs[4] == 1)?\"Set Vote\":\r\n               (this.props.selfs[4] == 2)?\"Set Tally\":\r\n               (this.props.selfs[4] == 3)?\"Setting finish\":\r\n               \"Finish\"}</Button></td>\r\n          <td><Link route={\"/Vote/status/\"+this.props.mb_addr+\"/\"+this.props.selfs[2]} ><a>link</a></Link></td>\r\n          <td><Link route={\"/Vote/admin/\"+this.props.mb_addr+\"/\"+this.props.selfs[2]} ><a>link</a></Link></td>\r\n        </>\r\n      );\r\n    }\r\n}\r\nclass Self_list extends Component{\r\n  //const vote_btn =function (stage ){\r\n      render(){\r\n      return (\r\n          <>\r\n          {this.props.list.map(self => <tr><Self key={self.id} mb_addr={this.props.mb_addr}></Self></tr>)}\r\n          </>\r\n      );\r\n      }\r\n};\r\nclass Home extends Component {\r\n        constructor(props) {\r\n          super(props);\r\n          this.state ={\r\n           // Mb_addr :props.query.address,\r\n            search : \"\",\r\n            addr:\"\",\r\n            loading : false,\r\n            loading2: false,\r\n            errorMessage:''\r\n          };\r\n          this.refresh_search = this.refresh_search.bind(this);\r\n          this.create_vote = this.create_vote.bind(this);\r\n          this.add_list = this.add_list.bind(this);\r\n        }\r\n        static async getInitialProps(props){\r\n          //const{mbaddr} = props.query;\r\n          const mb_addr = props.query.mb_addr;\r\n          //const accounts = await web3.eth.getAccounts();\r\n          const Mailbox = mailbox(mb_addr);\r\n          console.log(mb_addr);\r\n          let join = await Mailbox.methods.return_join_list().call();\r\n          //console.log(join);\r\n          //console.log(join.length);\r\n          var join_detail = [];\r\n          for (let index = 0; index < join.length; index++) {\r\n            let arr = [];\r\n            let v_addr = join[index];\r\n            let v = vote(v_addr);\r\n            arr[0] = (index+1).toString();\r\n            arr[1] = await v.methods.return_question().call();\r\n            arr[2] = v_addr;\r\n            //let t = await v.methods.return_time().call();\r\n            //console.log(t);\r\n            arr[3] = \"today\";\r\n            arr[4] = v_addr;\r\n            join_detail[index]=arr;\r\n          }\r\n          \r\n          let self = await Mailbox.methods.return_self_list().call();\r\n          var self_detail =[];\r\n          for (let index = 0; index < self.length; index++) {\r\n            let arr =[];\r\n            let v_addr = self[index];\r\n            let v = vote(v_addr);\r\n            arr[0] = (index+1).toString();\r\n            arr[1] = await v.methods.return_question().call();\r\n            arr[2] = v_addr;\r\n            //arr[3] = await v.methods.return_time().call();\r\n            arr[3] = \"today\";\r\n            arr[4] = await v.methods.return_stage().call();//return stage 之後要set stage\r\n            self_detail[index]=arr;\r\n            \r\n          }\r\n          console.log(self);\r\n          //console.log(join_detail);\r\n          return{mb_addr,join_detail,self_detail};\r\n      }\r\n    refresh_search(){\r\n       if(this.state.search != \"\")\r\n        Router.pushRoute(`/Vote/vote/${this.props.mb_addr}/${this.state.search}`);\r\n        //console.log(this.props.address);\r\n    }\r\n    async create_vote(){\r\n        const accounts = await web3.eth.getAccounts();\r\n        const Mailbox =await mailbox(this.props.mb_addr);\r\n        \r\n        try{\r\n            await Mailbox.methods.create_vote().send({from:accounts[0]});\r\n            Router.pushRoute(`/Vote/home/${this.props.mb_addr}`);\r\n          }\r\n          catch(err){\r\n            alert(err);\r\n          }\r\n    }\r\n    async add_list(){\r\n      const accounts = await web3.eth.getAccounts();\r\n      const Mailbox =await mailbox(this.props.mb_addr);\r\n      try{\r\n        await Mailbox.methods.add_to_join_list(this.state.addr).send({from:accounts[0]});\r\n        Router.pushRoute(`/Vote/home/${this.props.mb_addr}`);\r\n      }\r\n      catch(err){\r\n        alert(err);\r\n      }\r\n    }\r\n    render() {\r\n      \r\n        return(\r\n          <>\r\n          <link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css\" integrity=\"sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk\" crossOrigin=\"anonymous\"/>\r\n          <Container>\r\n          <Navbar bg=\"dark\" variant=\"dark\"style={{width:\"100%\"}}>\r\n             <Navbar.Brand >Vote</Navbar.Brand>\r\n              <Nav className=\"mr-auto\" style={{width:\"50%\"}}>\r\n                 <Link route={\"/Vote/index\" }  ><a style={{color: \"white\", width:\"100px\"}}>Logout</a></Link>\r\n              </Nav>\r\n             <Form inline>\r\n              <div style={{color : \"white\"}} > inesrt your vote contract address here  -&gt;   </div>\r\n              <FormControl type=\"text\" placeholder=\"Search\" className=\"mr-sm-2\"\r\n                  value={this.state.search} \r\n                  onChange = {event => this.setState({search:event.target.value})} />\r\n              <Button variant=\"outline-info\" onClick={this.refresh_search}>Search</Button>\r\n              </Form>\r\n         </Navbar>\r\n         \r\n         <div style={{width: '100%'}}>\r\n         <h2 style = {{width :'75%',margin:\"auto\",marginTop : \"3%\"}}>\r\n           Vote List (the vote you are invited)\r\n           <Form inline>\r\n              <h4> add vote contract address to list  -&gt;   </h4>\r\n              <FormControl type=\"text\" placeholder=\"add\" className=\"mr-sm-2\"\r\n                  value={this.state.addr} \r\n                  onChange = {event => this.setState({addr:event.target.value})} />\r\n              <Button variant=\"primary\" onClick={this.add_list}>Add</Button>\r\n              </Form>\r\n           </h2>\r\n         <Table striped bordered hover size=\"sm\" style = {{width :'75%',margin:\"auto\",marginTop : \"3%\"}}>\r\n          <thead>\r\n            <tr>\r\n              <th>#</th>\r\n              <th>vote name</th>\r\n              <th>vote address</th>\r\n              <th>due date</th>\r\n              <th>status</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody >\r\n          <Join_list list={this.props.join_detail} mb_addr={this.props.mb_addr}></Join_list>\r\n          </tbody>\r\n        </Table>\r\n        \r\n        </div>\r\n        <div style={{width: '100%'}}>\r\n        <h2 style = {{width :'75%',margin:\"auto\",marginTop : \"3%\"}}>\r\n          Vote Admin List (the vote you create)\r\n          <Button variant=\"primary\"  onClick={this.create_vote} >create new vote</Button>\r\n        </h2>\r\n        \r\n         <Table striped bordered hover size=\"sm\" style = {{width :'75%',margin:\"auto\",marginTop : \"3%\"}}>\r\n          <thead>\r\n            <tr>\r\n              <th>#</th>\r\n              <th>vote name</th>\r\n              <th>vote address</th>\r\n              <th>next step due date</th>\r\n              <th>nextstep</th>\r\n              <th>status</th>\r\n              <th>set question</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n          <Self_list list={this.props.self_detail} mb_addr={this.props.mb_addr}></Self_list>\r\n            {/* \r\n            <tr>\r\n              <td>1</td>\r\n              <td>should everyone wear mask on campus</td>\r\n              <td>0x1234556778999888</td>\r\n              <td>7/14</td>\r\n              <td><Link route=\"/vote\" >update setting</Link></td>\r\n            </tr>\r\n            <tr>\r\n              <td>2</td>\r\n              <td>should everyone wear mask on campus</td>\r\n              <td>0x1234556778999888</td>\r\n              <td>7/14</td>\r\n              <td><Link route=\"/vote\" >distribute vote contract</Link></td>\r\n            </tr>\r\n            <tr>\r\n              <td>3</td>\r\n              <td>should everyone wear mask on campus</td>\r\n              <td>0x1234556778999888</td>\r\n              <td>7/14</td>\r\n              <td><Link route=\"/vote\" >tally</Link></td>\r\n            </tr>*/}\r\n          </tbody>\r\n        </Table>\r\n        </div>\r\n       </Container>\r\n         </>\r\n    )\r\n    }\r\n}\r\n\r\n\r\nexport default Home;"]},"metadata":{},"sourceType":"module"}