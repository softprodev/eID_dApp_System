{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { Component, useState } from 'react';\nimport { Link } from '../../routes';\nimport Navbar from 'react-bootstrap/Navbar';\nimport Nav from 'react-bootstrap/Nav';\nimport Container from 'react-bootstrap/Nav';\nimport Form from 'react-bootstrap/Form';\nimport FormControl from 'react-bootstrap/FormControl';\nimport Button from 'react-bootstrap/Button';\nimport DatePicker from \"react-datepicker\";\nimport web3 from '../../ethereum/web3';\nimport { Router } from '../../routes';\nimport vote from '../../ethereum/Vote/vote';\n\nclass Admin extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      register_start_date: new Date(),\n      register_end_date: new Date(),\n      vote_start_date: new Date(),\n      vote_end_date: new Date(),\n      requirement: '',\n      question: '',\n      option: '',\n      loading: false,\n      loading2: false,\n      search: '',\n      errorMessage: ''\n    }; //console.log(props.query.address);//擷取這個網址的url那part的address(from routes??)  \n\n    this.submit_setting = this.submit_setting.bind(this);\n    this.submit_option = this.submit_option.bind(this);\n    this.refresh_search = this.refresh_search.bind(this); //const [ register_start_date, setDate ] = useState(new Date());\n  }\n\n  static async getInitialProps(props) {\n    const {\n      address,\n      mb_addr\n    } = props.query;\n    const Vote_event = await vote(address);\n    const option_length = await Vote_event.methods.return_options_length().call();\n    var options = [];\n\n    for (let index = 0; index < option_length; index++) {\n      let temp = await Vote_event.methods.return_options(index).call();\n      options.push(temp);\n    }\n\n    return {\n      address,\n      mb_addr,\n      options\n    };\n  }\n\n  async submit_setting(event) {\n    event.preventDefault();\n    const Vote = vote(this.props.address);\n    const {\n      register_start_date,\n      register_end_date,\n      vote_start_date,\n      vote_end_date,\n      requirement,\n      question\n    } = this.state; //console.log(this.state.register_end_date.getTime());\n    //console.log(register_start_date);\n\n    this.setState({\n      loading: true,\n      errorMessage: ''\n    });\n\n    try {\n      const accounts = await web3.eth.getAccounts();\n      await Vote.methods.set_up_all(question, register_start_date.getTime(), register_end_date.getTime(), vote_start_date.getTime(), vote_end_date.getTime(), requirement).send({\n        from: accounts[0]\n      }); //Router.pushRoute(`/campaigns/${this.props.address}/requests`)\n\n      alert(\"Setting Successfully\");\n    } catch (err) {\n      alert(err);\n    }\n\n    this.setState({\n      loading: false\n    });\n  }\n\n  async submit_option(event) {\n    event.preventDefault();\n    const Vote = vote(this.props.address);\n    const {\n      option\n    } = this.state; //console.log(this.state.register_end_date.getTime());\n    //console.log(register_start_date);\n\n    this.setState({\n      loading2: true\n    });\n\n    try {\n      const accounts = await web3.eth.getAccounts();\n      await Vote.methods.set_up_options().send({\n        from: accounts[0]\n      }); //Router.pushRoute(`/campaigns/${this.props.address}/requests`)\n\n      alert(\"Setting Option Successfully\");\n    } catch (err) {\n      alert(err);\n    }\n\n    this.setState({\n      loading: false\n    });\n  }\n\n  refresh_search() {\n    if (this.state.search != \"\") {\n      Router.pushRoute(`/admin/${this.props.mb_addr}/${this.state.search}`);\n      console.log(this.props.address);\n    }\n  } //還可能要有顯示目前option的功能\n\n\n  render() {\n    //const [date, setDate] = useState(new Date());\n    return __jsx(React.Fragment, null, __jsx(\"link\", {\n      rel: \"stylesheet\",\n      href: \"https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css\",\n      integrity: \"sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk\",\n      crossOrigin: \"anonymous\"\n    }), __jsx(\"link\", {\n      rel: \"stylesheet\",\n      href: \"https://cdnjs.cloudflare.com/ajax/libs/react-datepicker/3.1.3/react-datepicker.min.css\",\n      integrity: \"sha512-Nc2rvPMo6xXLoInVUZRxo3qMVFCQ8o1PzK/9eGjutJvr0Y/PM6u4Gg5Rg3xO33jsAq9L4Uc/PM0bitnlOh0wpw==\",\n      crossorigin: \"anonymous\"\n    }), __jsx(Container, null, __jsx(Navbar, {\n      bg: \"dark\",\n      variant: \"dark\",\n      style: {\n        width: \"100%\"\n      }\n    }, __jsx(Navbar.Brand, null, __jsx(Link, {\n      route: \"/vote/\" + this.props.address\n    }, __jsx(\"a\", {\n      style: {\n        color: \"white\",\n        width: \"100px\"\n      }\n    }, \"Vote\"))), __jsx(Nav, {\n      className: \"mr-auto\",\n      style: {\n        width: \"50%\"\n      }\n    }, __jsx(Link, {\n      route: \"/home/\" + this.props.address\n    }, __jsx(\"a\", {\n      style: {\n        color: \"white\",\n        width: \"100px\"\n      }\n    }, \"Home\")), __jsx(Link, {\n      route: \"/status/\" + this.props.address\n    }, __jsx(\"a\", {\n      style: {\n        color: \"white\",\n        width: \"100px\"\n      }\n    }, \"Status\")), __jsx(Link, {\n      route: \"/index\"\n    }, __jsx(\"a\", {\n      style: {\n        color: \"white\",\n        width: \"100px\"\n      }\n    }, \"Logout\"))), __jsx(Form, {\n      inline: true\n    }, __jsx(\"div\", {\n      style: {\n        color: \"white\"\n      }\n    }, \" inesrt your vote contract address here  ->   \"), __jsx(FormControl, {\n      type: \"text\",\n      placeholder: \"Search\",\n      className: \"mr-sm-2\",\n      value: this.state.search,\n      onChange: event => this.setState({\n        search: event.target.value\n      })\n    }), __jsx(Button, {\n      variant: \"outline-info\",\n      onClick: this.refresh_search\n    }, \"Search\"))), __jsx(\"div\", {\n      style: {\n        margin: \"auto\"\n      }\n    }, __jsx(Form, {\n      style: {\n        margin: \"auto\",\n        marginTop: \"3%\"\n      },\n      onSubmit: this.submit_setting\n    }, __jsx(\"h2\", null, \"Edit Setting\"), __jsx(Form.Row, null, __jsx(Form.Group, {\n      as: \"new_vote\",\n      controlId: \"Issue\"\n    }, __jsx(Form.Label, null, \"The Issue you want to vote\"), __jsx(Form.Control, {\n      type: \"text\",\n      placeholder: \"Enter issue\",\n      value: this.state.question,\n      onChange: event => this.setState({\n        question: event.target.value\n      })\n    }))), __jsx(Form.Row, null, __jsx(Form.Group, {\n      as: \"register_start_date\",\n      controlId: \"register_start_date\"\n    }, __jsx(Form.Label, null, \"register_start_date\"), __jsx(DatePicker, {\n      selected: this.state.register_start_date,\n      onChange: date => {\n        this.setState({\n          register_start_date: date\n        });\n      }\n    })), __jsx(Form.Group, {\n      as: \"register_end_date\",\n      controlId: \"register_end_date\"\n    }, __jsx(Form.Label, null, \"register_end_date\"), __jsx(DatePicker, {\n      selected: this.state.register_end_date,\n      onChange: date => {\n        this.setState({\n          register_end_date: date\n        });\n      }\n    }))), __jsx(Form.Row, null, __jsx(Form.Group, {\n      as: \"vote_start_date\",\n      controlId: \"vote_start_date\"\n    }, __jsx(Form.Label, null, \"vote_start_date\"), __jsx(DatePicker, {\n      selected: this.state.vote_start_date,\n      onChange: date => {\n        this.setState({\n          vote_start_date: date\n        });\n      }\n    })), __jsx(Form.Group, {\n      as: \"vote_end_date\",\n      controlId: \"vote_end_date\"\n    }, __jsx(Form.Label, null, \"vote_end_date\"), __jsx(DatePicker, {\n      selected: this.state.vote_end_date,\n      onChange: date => {\n        this.setState({\n          vote_end_date: date\n        });\n      }\n    }))), __jsx(Form.Row, null, __jsx(Form.Group, {\n      as: \"requirement\",\n      controlId: \"requirement\"\n    }, __jsx(Form.Label, null, \"vote requirement\"), __jsx(Form.Control, {\n      type: \"text\",\n      placeholder: \"Enter requirement\",\n      value: this.state.requirement,\n      onChange: event => this.setState({\n        requirement: event.target.value\n      })\n    }))), __jsx(Button, {\n      variant: \"primary\",\n      type: \"submit\"\n    }, \"Setting\")), __jsx(Form, {\n      style: {\n        margin: \"auto\",\n        marginTop: \"3%\"\n      },\n      onSubmit: this.submit_setting\n    }, __jsx(\"h2\", null, \"Set options one by one\"), __jsx(Form.Row, null, __jsx(Form.Group, {\n      controlId: \"option\"\n    }, __jsx(Form.Label, null, \"option\"), this.props.options.map((option, index) => {\n      __jsx(\"h3\", null, option, \",\", index);\n    }), __jsx(Form.Control, {\n      type: \"text\",\n      placeholder: \"option\",\n      value: this.state.option,\n      onChange: event => this.setState({\n        option: event.target.value\n      })\n    }))), __jsx(Button, {\n      variant: \"primary\",\n      type: \"submit\"\n    }, \"Set options\")))));\n  }\n\n}\n\nexport default Admin;","map":{"version":3,"sources":["C:/Users/suvin/vincent/Dapp/nextjs-web/pages/Vote/admin.js"],"names":["React","Component","useState","Link","Navbar","Nav","Container","Form","FormControl","Button","DatePicker","web3","Router","vote","Admin","constructor","props","state","register_start_date","Date","register_end_date","vote_start_date","vote_end_date","requirement","question","option","loading","loading2","search","errorMessage","submit_setting","bind","submit_option","refresh_search","getInitialProps","address","mb_addr","query","Vote_event","option_length","methods","return_options_length","call","options","index","temp","return_options","push","event","preventDefault","Vote","setState","accounts","eth","getAccounts","set_up_all","getTime","send","from","alert","err","set_up_options","pushRoute","console","log","render","width","color","target","value","margin","marginTop","date","map"],"mappings":"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","sourcesContent":["import React, { Component,useState } from 'react';\r\nimport{Link}from '../../routes';\r\n\r\nimport Navbar from 'react-bootstrap/Navbar';\r\nimport Nav from 'react-bootstrap/Nav';\r\nimport Container from 'react-bootstrap/Nav';\r\nimport Form from 'react-bootstrap/Form';\r\nimport FormControl from 'react-bootstrap/FormControl';\r\nimport Button from 'react-bootstrap/Button';\r\nimport DatePicker from \"react-datepicker\";\r\n\r\nimport web3 from '../../ethereum/web3'\r\nimport {Router}from '../../routes';\r\nimport vote from '../../ethereum/Vote/vote';\r\n\r\n\r\nclass Admin extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state ={\r\n          register_start_date:new Date(),\r\n          register_end_date:new Date(),\r\n          vote_start_date:new Date(),\r\n          vote_end_date:new Date(),\r\n          requirement:'',\r\n          question:'',\r\n          option:'',\r\n          loading : false,\r\n          loading2: false,\r\n          search:'',\r\n          errorMessage:''\r\n        };\r\n      //console.log(props.query.address);//擷取這個網址的url那part的address(from routes??)  \r\n      this.submit_setting = this.submit_setting.bind(this);\r\n      this.submit_option = this.submit_option.bind(this);\r\n      this.refresh_search = this.refresh_search.bind(this);\r\n      //const [ register_start_date, setDate ] = useState(new Date());\r\n      }\r\n    static async getInitialProps(props){\r\n        const{address,mb_addr} = props.query;\r\n        const Vote_event =await vote(address);\r\n        const option_length = await Vote_event.methods.return_options_length().call();\r\n        var options = [];\r\n        for (let index = 0; index < option_length; index++) {\r\n            let temp = await Vote_event.methods.return_options(index).call();\r\n            options.push(temp);\r\n        }\r\n        return{address,mb_addr,options};\r\n    }\r\n    async submit_setting(event){\r\n        event.preventDefault();\r\n\r\n        const Vote = vote(this.props.address);\r\n\r\n        const {register_start_date,register_end_date,vote_start_date,vote_end_date,requirement,question} = this.state;\r\n        //console.log(this.state.register_end_date.getTime());\r\n        //console.log(register_start_date);\r\n        this.setState({loading:true,errorMessage:''});\r\n        \r\n        try{\r\n            const accounts = await web3.eth.getAccounts();\r\n            await Vote.methods.set_up_all(\r\n                question,\r\n                register_start_date.getTime(),\r\n                register_end_date.getTime(),\r\n                vote_start_date.getTime(),\r\n                vote_end_date.getTime(),\r\n                requirement\r\n            ).send(\r\n                {from:accounts[0]}\r\n            );\r\n            //Router.pushRoute(`/campaigns/${this.props.address}/requests`)\r\n            alert(\"Setting Successfully\")\r\n        }catch(err){\r\n            alert(err);\r\n        }\r\n        this.setState({loading:false});\r\n    }\r\n    async submit_option(event){\r\n        event.preventDefault();\r\n\r\n        const Vote = vote(this.props.address);\r\n\r\n        const {option} = this.state;\r\n        //console.log(this.state.register_end_date.getTime());\r\n        //console.log(register_start_date);\r\n        this.setState({loading2:true});\r\n        \r\n        try{\r\n            const accounts = await web3.eth.getAccounts();\r\n            await Vote.methods.set_up_options(\r\n                \r\n            ).send(\r\n                {from:accounts[0]}\r\n            );\r\n            //Router.pushRoute(`/campaigns/${this.props.address}/requests`)\r\n            alert(\"Setting Option Successfully\")\r\n        }catch(err){\r\n            alert(err);\r\n        }\r\n        this.setState({loading:false});\r\n    }\r\n    refresh_search(){\r\n        if(this.state.search != \"\"){\r\n        Router.pushRoute(`/admin/${this.props.mb_addr}/${this.state.search}`);\r\n        console.log(this.props.address);\r\n        }\r\n    }\r\n    //還可能要有顯示目前option的功能\r\n    render() {\r\n        //const [date, setDate] = useState(new Date());\r\n        return(\r\n        <>\r\n         <link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css\" integrity=\"sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk\" crossOrigin=\"anonymous\"/>\r\n         <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/react-datepicker/3.1.3/react-datepicker.min.css\" integrity=\"sha512-Nc2rvPMo6xXLoInVUZRxo3qMVFCQ8o1PzK/9eGjutJvr0Y/PM6u4Gg5Rg3xO33jsAq9L4Uc/PM0bitnlOh0wpw==\" crossorigin=\"anonymous\" />\r\n         <Container>\r\n         <Navbar bg=\"dark\" variant=\"dark\"style={{width:\"100%\"}}>\r\n            <Navbar.Brand ><Link route={\"/vote/\"+this.props.address } ><a style={{color: \"white\", width:\"100px\"}}>Vote</a></Link></Navbar.Brand>\r\n             <Nav className=\"mr-auto\" style={{width:\"50%\"}}>\r\n                <Link route={\"/home/\"+this.props.address }><a style={{color: \"white\", width:\"100px\"}}>Home</a></Link>\r\n                <Link route={\"/status/\"+this.props.address } ><a style={{color: \"white\", width:\"100px\"}}>Status</a></Link>\r\n                <Link route={\"/index\" }  ><a style={{color: \"white\", width:\"100px\"}}>Logout</a></Link>\r\n             </Nav>\r\n            <Form inline>\r\n            <div style={{color : \"white\"}} > inesrt your vote contract address here  -&gt;   </div>\r\n            <FormControl type=\"text\" placeholder=\"Search\" className=\"mr-sm-2\" \r\n                value={this.state.search} \r\n                onChange = {event => this.setState({search:event.target.value})} />\r\n            <Button variant=\"outline-info\" onClick={this.refresh_search}>Search</Button>\r\n            </Form>\r\n        </Navbar>\r\n        <div style={{margin:\"auto\"}}>\r\n        <Form style={{ margin :\"auto\",marginTop :\"3%\"}} onSubmit = {this.submit_setting}>\r\n        <h2>Edit Setting</h2>\r\n            <Form.Row>\r\n                <Form.Group as=\"new_vote\" controlId=\"Issue\">\r\n                <Form.Label>The Issue you want to vote</Form.Label>\r\n                <Form.Control type=\"text\" placeholder=\"Enter issue\" \r\n                    value={this.state.question} \r\n                    onChange = {event => this.setState({question:event.target.value})} \r\n                />\r\n                </Form.Group>\r\n\r\n            </Form.Row>{/*\r\n            <Form.Row>\r\n                <Form.Group as=\"gap\" controlId=\"gap\">\r\n                <Form.Label>gap time</Form.Label>\r\n                <Form.Control type=\"number\" placeholder=\"Enter gap time\" />\r\n                </Form.Group>\r\n                <Form.Group as=\"entrance_fee\" controlId=\"entrance_fee\">\r\n                <Form.Label>entrance fee</Form.Label>\r\n                <Form.Control type=\"number\" placeholder=\"entrance fee\" />\r\n                </Form.Group>\r\n            </Form.Row>*/}\r\n            <Form.Row>\r\n                \r\n                <Form.Group as=\"register_start_date\" controlId=\"register_start_date\">\r\n                <Form.Label>register_start_date</Form.Label>\r\n                <DatePicker selected={this.state.register_start_date} \r\n                            onChange={date => {this.setState({register_start_date: date})}}/>\r\n                </Form.Group>\r\n                <Form.Group as=\"register_end_date\"  controlId=\"register_end_date\">\r\n                <Form.Label>register_end_date</Form.Label>\r\n                <DatePicker selected={this.state.register_end_date} \r\n                            onChange={date => {this.setState({register_end_date: date})}} />\r\n                </Form.Group>\r\n            </Form.Row>\r\n\r\n            <Form.Row>\r\n                \r\n                <Form.Group as=\"vote_start_date\" controlId=\"vote_start_date\">\r\n                <Form.Label>vote_start_date</Form.Label>\r\n                <DatePicker selected={this.state.vote_start_date} \r\n                            onChange={date => {this.setState({vote_start_date: date})}} />\r\n                </Form.Group>\r\n                <Form.Group as=\"vote_end_date\"  controlId=\"vote_end_date\">\r\n                <Form.Label>vote_end_date</Form.Label>\r\n                <DatePicker selected={this.state.vote_end_date} \r\n                            onChange={date => {this.setState({vote_end_date: date})}} />\r\n                </Form.Group>\r\n            </Form.Row>\r\n\r\n            <Form.Row>\r\n            <Form.Group as=\"requirement\" controlId=\"requirement\">\r\n                <Form.Label>vote requirement</Form.Label>\r\n                <Form.Control type=\"text\" placeholder=\"Enter requirement\" \r\n                    value={this.state.requirement} \r\n                    onChange = {event => this.setState({requirement:event.target.value})}\r\n                />\r\n                </Form.Group>\r\n                    \r\n            </Form.Row>\r\n\r\n            <Button variant=\"primary\" type=\"submit\">\r\n                Setting\r\n            </Button>\r\n        </Form>\r\n        \r\n        <Form style={{ margin :\"auto\",marginTop :\"3%\"}} onSubmit = {this.submit_setting}>\r\n        <h2>Set options one by one</h2>\r\n            <Form.Row>\r\n                <Form.Group controlId=\"option\">\r\n                    <Form.Label>option</Form.Label>\r\n                        {this.props.options.map((option, index) =>{<h3>{option},{index}</h3>})}\r\n                    <Form.Control type=\"text\" placeholder=\"option\" \r\n                        value={this.state.option} \r\n                        onChange = {event => this.setState({option:event.target.value})}\r\n                    />\r\n                </Form.Group>\r\n            </Form.Row>\r\n            <Button variant=\"primary\" type=\"submit\">\r\n                Set options\r\n            </Button>\r\n            </Form>\r\n            </div>\r\n      </Container>\r\n        </>\r\n    )\r\n    }\r\n}\r\n\r\n\r\nexport default Admin;"]},"metadata":{},"sourceType":"module"}