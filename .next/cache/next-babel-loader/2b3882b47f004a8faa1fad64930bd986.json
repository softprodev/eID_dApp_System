{"ast":null,"code":"var __jsx = React.createElement;\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { Component } from 'react';\nimport { Link } from '../routes';\nimport Navbar from 'react-bootstrap/Navbar';\nimport Nav from 'react-bootstrap/Nav';\nimport Container from 'react-bootstrap/Nav';\nimport Form from 'react-bootstrap/Form';\nimport FormControl from 'react-bootstrap/FormControl';\nimport Button from 'react-bootstrap/Button';\nimport { Card, Table } from 'react-bootstrap';\nimport factory from '../ethereum/factory';\nimport web3 from '../ethereum/web3';\nimport { Router } from '../routes';\n\nclass Index extends Component {\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"state\", {\n      loading: false,\n      loading2: false,\n      errorMessage: ''\n    });\n\n    this.state = {\n      loading: false,\n      loading2: false,\n      errorMessage: ''\n    }; // 為了讓 `this` 能在 callback 中被使用，這裡的綁定是必要的：\n\n    this.login = this.login.bind(this);\n    this.create = this.create.bind(this);\n  }\n\n  async login(event) {\n    try {\n      event.preventDefault();\n      this.setState({\n        loading: true\n      });\n      var accounts = await web3.eth.getAccounts();\n      console.log(accounts[0]);\n      const addr = await factory.methods.return_addr(accounts[0]).call();\n      if (addr != null) Router.pushRoute(`/home/${addr}`);else alert(\"please create a mailbox first!\");\n      this.setState({\n        loading: false\n      });\n    } catch (err) {\n      alert(err);\n      this.setState({\n        loading: false\n      });\n    }\n  }\n\n  async create(event) {\n    try {\n      event.preventDefault();\n      this.setState({\n        loading2: true\n      });\n      var accounts = await web3.eth.getAccounts();\n      let addr = await factory.methods.return_addr(accounts[0]).call();\n      if (addr != null) Router.pushRoute(`/home/${addr}`);else {\n        await factory.methods.create_mailbox().send({\n          from: accounts[0]\n        });\n        let addr = await factory.methods.return_addr(accounts[0]).call();\n        if (addr != null) Router.pushRoute(`/home/${addr}`);else alert(\"somthing wrong please try again!\");\n        this.setState({\n          loading2: false\n        });\n      }\n    } catch (err) {\n      alert(err);\n      this.setState({\n        loading2: false\n      });\n    }\n  }\n\n  render() {\n    return __jsx(React.Fragment, null, __jsx(\"link\", {\n      rel: \"stylesheet\",\n      href: \"https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css\",\n      integrity: \"sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk\",\n      crossOrigin: \"anonymous\"\n    }), __jsx(Container, null, __jsx(Navbar, {\n      bg: \"dark\",\n      variant: \"dark\",\n      style: {\n        width: \"100%\"\n      }\n    }, __jsx(Navbar.Brand, null, __jsx(Link, {\n      route: \"/vote\"\n    }, __jsx(\"a\", {\n      style: {\n        color: \"white\",\n        width: \"100px\"\n      }\n    }, \"Vote\"))), __jsx(Nav, {\n      className: \"mr-auto\",\n      style: {\n        width: \"50%\"\n      }\n    }, __jsx(Link, {\n      route: \"/status\"\n    }, __jsx(\"a\", {\n      style: {\n        color: \"white\",\n        width: \"100px\"\n      }\n    }, \"Status\")), __jsx(Link, {\n      route: \"/admin\"\n    }, __jsx(\"a\", {\n      style: {\n        color: \"white\",\n        width: \"100px\"\n      }\n    }, \"CreateVote\")), __jsx(Link, {\n      route: \"/home\"\n    }, __jsx(\"a\", {\n      style: {\n        color: \"white\",\n        width: \"100px\"\n      }\n    }, \"home\")))), __jsx(\"div\", {\n      style: {\n        margin: \"auto\"\n      }\n    }, __jsx(\"h2\", {\n      style: {\n        margin: \"auto\",\n        marginTop: \"30%\"\n      }\n    }, \"Login to your mailbox\", __jsx(Button, {\n      variant: \"outline-info\",\n      style: {\n        width: '75%',\n        margin: \"auto\",\n        marginTop: \"3%\"\n      },\n      onClick: this.login,\n      loading: this.state.loading.toString()\n    }, \"Login to your mailbox\")), __jsx(\"h2\", {\n      style: {\n        margin: \"auto\",\n        marginTop: \"30%\"\n      }\n    }, \"Create your new mailbox\", __jsx(Button, {\n      variant: \"outline-info\",\n      style: {\n        width: '75%',\n        margin: \"auto\",\n        marginTop: \"3%\"\n      },\n      onClick: this.create,\n      loading: this.state.loading2.toString()\n    }, \"Create new mailbox\")))));\n  }\n\n}\n\nexport default Index;","map":{"version":3,"sources":["/Users/suvincent/vote-web/pages/index.js"],"names":["React","Component","Link","Navbar","Nav","Container","Form","FormControl","Button","Card","Table","factory","web3","Router","Index","constructor","props","loading","loading2","errorMessage","state","login","bind","create","event","preventDefault","setState","accounts","eth","getAccounts","console","log","addr","methods","return_addr","call","pushRoute","alert","err","create_mailbox","send","from","render","width","color","margin","marginTop","toString"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport{Link}from '../routes';\n\nimport Navbar from 'react-bootstrap/Navbar';\nimport Nav from 'react-bootstrap/Nav';\nimport Container from 'react-bootstrap/Nav';\nimport Form from 'react-bootstrap/Form';\nimport FormControl from 'react-bootstrap/FormControl';\nimport Button from 'react-bootstrap/Button';\nimport {Card,Table} from 'react-bootstrap';\nimport factory from '../ethereum/factory';\nimport web3 from '../ethereum/web3'\nimport {Router}from '../routes';\nclass Index extends Component {\n      state ={\n        loading : false,\n        loading2: false,\n        errorMessage:''\n    };\n    constructor(props) {\n      super(props);\n      this.state ={\n        loading : false,\n        loading2: false,\n        errorMessage:''\n    };\n      // 為了讓 `this` 能在 callback 中被使用，這裡的綁定是必要的：\n      this.login = this.login.bind(this);\n      this.create= this.create.bind(this);\n    }\n    async login(event){\n      try{\n        event.preventDefault();\n        this.setState({loading:true});\n        var accounts = await web3.eth.getAccounts();\n        console.log(accounts[0]);\n        const addr =await factory.methods.return_addr(accounts[0]).call();\n        if(addr!=null)Router.pushRoute(`/home/${addr}`);\n        else alert(\"please create a mailbox first!\")\n        this.setState({loading:false});\n      }\n      catch(err){\n        alert(err);\n        this.setState({loading:false});\n      }\n    }\n    async create(event){\n      try{\n        event.preventDefault();\n        this.setState({loading2:true});\n        var accounts = await web3.eth.getAccounts();\n        let addr =await factory.methods.return_addr(accounts[0]).call();\n        if(addr!=null)Router.pushRoute(`/home/${addr}`);\n        else {\n          await factory.methods.create_mailbox().send({from:accounts[0]});\n          let addr =await factory.methods.return_addr(accounts[0]).call();\n          if(addr!=null)Router.pushRoute(`/home/${addr}`);\n          else alert(\"somthing wrong please try again!\");\n          this.setState({loading2:false});\n        }\n      }\n      catch(err){\n        alert(err);\n        this.setState({loading2:false});\n      }\n    }\n    render() {\n        return(\n          <>\n          <link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css\" integrity=\"sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk\" crossOrigin=\"anonymous\"/>\n          <Container>\n          <Navbar bg=\"dark\" variant=\"dark\"style={{width:\"100%\"}}>\n             <Navbar.Brand ><Link route=\"/vote\" ><a style={{color: \"white\", width:\"100px\"}}>Vote</a></Link></Navbar.Brand>\n              <Nav className=\"mr-auto\" style={{width:\"50%\"}}>\n                 <Link route=\"/status\" ><a style={{color: \"white\", width:\"100px\"}}>Status</a></Link>\n                 <Link route=\"/admin\" ><a style={{color: \"white\", width:\"100px\"}}>CreateVote</a></Link>\n                 <Link route=\"/home\" ><a style={{color: \"white\", width:\"100px\"}}>home</a></Link>\n              </Nav>\n         </Navbar>\n         \n         <div style={{margin:\"auto\"}}>\n          <h2 style = {{margin:\"auto\",marginTop : \"30%\"}}>\n            Login to your mailbox\n          <Button variant=\"outline-info\" style = {{width :'75%',margin:\"auto\",marginTop : \"3%\"}} onClick={this.login} loading={this.state.loading.toString()}>Login to your mailbox</Button>\n          </h2>\n          <h2 style = {{margin:\"auto\",marginTop : \"30%\"}}>\n            Create your new mailbox\n          <Button variant=\"outline-info\" style = {{width :'75%',margin:\"auto\",marginTop : \"3%\"}} onClick={this.create} loading={this.state.loading2.toString()}>Create new mailbox</Button>\n          </h2>\n        </div>\n       </Container>\n         </>\n    )\n    }\n}\n\n\nexport default Index;"]},"metadata":{},"sourceType":"module"}