{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from 'react';\nimport { Link } from '../../routes';\nimport Navbar from 'react-bootstrap/Navbar';\nimport Nav from 'react-bootstrap/Nav';\nimport Container from 'react-bootstrap/Nav';\nimport Form from 'react-bootstrap/Form';\nimport FormControl from 'react-bootstrap/FormControl';\nimport Button from 'react-bootstrap/Button';\nimport { Card } from 'react-bootstrap';\nimport web3 from '../../ethereum/web3';\nimport { Router } from '../../routes';\nimport vote from '../../ethereum/Vote/vote';\nimport registry from '../../ethereum/Vote/registry';\n\nvar show_btn = function show_btn(stage) {\n  if (stage != 0) return null; //console.log(stage);\n\n  return __jsx(\"div\", null, \"this vote still needs setting please wait\");\n};\n\nvar Register_btn = /*#__PURE__*/function (_Component) {\n  _inherits(Register_btn, _Component);\n\n  var _super = _createSuper(Register_btn);\n\n  //const register_btn =function ( stage ){\n  function Register_btn(props) {\n    var _this;\n\n    _classCallCheck(this, Register_btn);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      registry_addr: \"\"\n    };\n    _this.register = _this.register.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(Register_btn, [{\n    key: \"register\",\n    value: function () {\n      var _register = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var accounts, Vote_event, hash;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return web3.eth.getAccounts();\n\n              case 2:\n                accounts = _context.sent;\n                _context.next = 5;\n                return vote(this.props.address);\n\n              case 5:\n                Vote_event = _context.sent;\n                hash = CryptoJS.SHA3(\"human\", {\n                  outputLength: 256\n                }).toString(); //console.log(web3.utils.fromAscii(hash));\n\n                _context.prev = 7;\n                _context.next = 10;\n                return Vote_event.methods.register('0x' + hash, this.state.registry_addr).send({\n                  from: accounts[0]\n                });\n\n              case 10:\n                Router.pushRoute(\"/Vote/vote/\".concat(this.props.mb_addr, \"/\").concat(this.props.address));\n                _context.next = 16;\n                break;\n\n              case 13:\n                _context.prev = 13;\n                _context.t0 = _context[\"catch\"](7);\n                alert(_context.t0.message);\n\n              case 16:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[7, 13]]);\n      }));\n\n      function register() {\n        return _register.apply(this, arguments);\n      }\n\n      return register;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      //console.log(this.props.stage );\n      if (this.props.stage != 1) return null;\n      return __jsx(React.Fragment, null, __jsx(FormControl, {\n        type: \"text\",\n        placeholder: \"enter your registry number\",\n        className: \"mr-sm-2\",\n        value: this.state.registry_addr,\n        onChange: function onChange(event) {\n          return _this2.setState({\n            registry_addr: event.target.value\n          });\n        }\n      }), __jsx(Button, {\n        variant: \"outline-info\",\n        style: {\n          margin: \"2%\"\n        },\n        onClick: this.register\n      }, \"register\"));\n    }\n  }]);\n\n  return Register_btn;\n}(Component);\n\n;\n\nvar Vote_btn = /*#__PURE__*/function (_Component2) {\n  _inherits(Vote_btn, _Component2);\n\n  var _super2 = _createSuper(Vote_btn);\n\n  //const vote_btn =function (stage ){\n  function Vote_btn(props) {\n    var _this3;\n\n    _classCallCheck(this, Vote_btn);\n\n    _this3 = _super2.call(this, props);\n    _this3.state = {\n      vote_value: 0\n    };\n    _this3.go_vote = _this3.go_vote.bind(_assertThisInitialized(_this3));\n    return _this3;\n  }\n\n  _createClass(Vote_btn, [{\n    key: \"go_vote\",\n    value: function () {\n      var _go_vote = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                console.log(this.state.vote_value); //const accounts = await web3.eth.getAccounts();\n                //await this.props.Vote_event.methods.register().send({from:accounts[0]});\n\n              case 1:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function go_vote() {\n        return _go_vote.apply(this, arguments);\n      }\n\n      return go_vote;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (this.props.stage != 2) return null;\n      return __jsx(React.Fragment, null, __jsx(Form, {\n        style: {\n          width: '33%',\n          margin: 'auto',\n          marginTop: \"2%\"\n        },\n        onSubmit: this.go_vote\n      }, __jsx(Form.Group, null, __jsx(Form.Control, {\n        as: \"select\",\n        size: \"lg\",\n        value: this.state.vote_value\n      }, this.props.ops.map(function (op) {\n        return __jsx(\"option\", null, op);\n      }))), __jsx(Button, {\n        variant: \"outline-info\",\n        style: {\n          margin: \"2%\"\n        },\n        type: \"submit\"\n      }, \"Vote\")));\n    }\n  }]);\n\n  return Vote_btn;\n}(Component);\n\n;\n\nvar Votesss = /*#__PURE__*/function (_Component3) {\n  _inherits(Votesss, _Component3);\n\n  var _super3 = _createSuper(Votesss);\n\n  function Votesss(props) {\n    var _this4$state;\n\n    var _this4;\n\n    _classCallCheck(this, Votesss);\n\n    _this4 = _super3.call(this, props);\n    _this4.state = (_this4$state = {\n      search: \"\",\n      loading: false,\n      loading2: false,\n      stage: ''\n    }, _defineProperty(_this4$state, \"search\", ''), _defineProperty(_this4$state, \"errorMessage\", ''), _defineProperty(_this4$state, \"html_test\", null), _defineProperty(_this4$state, \"mailbox_addr\", ''), _this4$state); //console.log(props.query.address);//擷取這個網址的url那part的address(from routes??)  \n\n    _this4.refresh_search = _this4.refresh_search.bind(_assertThisInitialized(_this4));\n    _this4.go_vote = _this4.go_vote.bind(_assertThisInitialized(_this4)); //this.see_status = this.see_status(this);\n\n    return _this4;\n  }\n\n  _createClass(Votesss, [{\n    key: \"refresh_search\",\n    value: function refresh_search() {\n      if (this.state.search != \"\") Router.pushRoute(\"/Vote/vote/\".concat(this.state.search)); //console.log(this.props.address);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this5 = this;\n\n      return __jsx(React.Fragment, null, __jsx(\"link\", {\n        rel: \"stylesheet\",\n        href: \"https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css\",\n        integrity: \"sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk\",\n        crossOrigin: \"anonymous\"\n      }), __jsx(\"script\", {\n        src: \"https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.js\"\n      }), __jsx(Container, null, __jsx(Navbar, {\n        bg: \"dark\",\n        variant: \"dark\",\n        style: {\n          width: \"100%\"\n        }\n      }, __jsx(Navbar.Brand, null, \"Vote\"), __jsx(Nav, {\n        className: \"mr-auto\",\n        style: {\n          width: \"50%\"\n        }\n      }, __jsx(Link, {\n        route: \"/Vote/home/\" + this.props.mb_addr\n      }, __jsx(\"a\", {\n        style: {\n          color: \"white\",\n          width: \"100px\"\n        }\n      }, \"Home\")), __jsx(Link, {\n        route: \"/Vote/status/\" + this.props.mb_addr + \"/\" + this.props.address\n      }, __jsx(\"a\", {\n        style: {\n          color: \"white\",\n          width: \"100px\"\n        }\n      }, \"Status\")), __jsx(Link, {\n        route: \"/Vote/index\"\n      }, __jsx(\"a\", {\n        style: {\n          color: \"white\",\n          width: \"100px\"\n        }\n      }, \"Logout\")))), __jsx(\"div\", {\n        style: {\n          width: '100%'\n        }\n      }, __jsx(Form, {\n        inline: true,\n        style: {\n          width: '33%',\n          margin: 'auto',\n          marginTop: \"2%\"\n        }\n      }, __jsx(\"div\", {\n        style: {\n          color: \"black\"\n        }\n      }, \" inesrt your vote contract address here  ->   \"), __jsx(FormControl, {\n        type: \"text\",\n        placeholder: \"Search\",\n        className: \"mr-sm-2\",\n        value: this.state.search,\n        onChange: function onChange(event) {\n          return _this5.setState({\n            search: event.target.value\n          });\n        }\n      }), __jsx(Button, {\n        variant: \"outline-info\",\n        onClick: this.refresh_search\n      }, \"Search\")), __jsx(Card, {\n        style: {\n          width: '33%',\n          margin: 'auto',\n          marginTop: \"2%\"\n        }\n      }, __jsx(Card.Body, null, __jsx(Card.Title, null, \"Election\"), __jsx(Card.Subtitle, {\n        className: \"mb-2 text-muted\"\n      }, \"voter address : \", this.props.address), __jsx(Card.Text, null, \"View the latest 2020 presidential polls and head-to-head match-up between Joe Biden and Donald Trump. For more information, view cnn.com/election.\"), __jsx(Card.Text, null, this.props.stage_str), show_btn(this.props.stage), __jsx(Register_btn, {\n        stage: this.props.stage,\n        address: this.props.address,\n        mb_addr: this.props.mb_addr\n      }), __jsx(Vote_btn, {\n        stage: this.props.stage,\n        ops: this.props.options,\n        address: this.props.address,\n        mb_addr: this.props.mb_addr\n      })))), __jsx(\"div\", {\n        style: {\n          width: '100%'\n        }\n      })));\n    }\n  }], [{\n    key: \"getInitialProps\",\n    value: function () {\n      var _getInitialProps = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(props) {\n        var _props$query, address, mb_addr, Vote_event, stage, option_length, stage_str, options, index, temp;\n\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _props$query = props.query, address = _props$query.address, mb_addr = _props$query.mb_addr;\n                _context3.next = 3;\n                return vote(address);\n\n              case 3:\n                Vote_event = _context3.sent;\n                _context3.next = 6;\n                return Vote_event.methods.return_stage().call();\n\n              case 6:\n                stage = _context3.sent;\n                _context3.next = 9;\n                return Vote_event.methods.return_options_length().call();\n\n              case 9:\n                option_length = _context3.sent;\n                stage_str = stage == 0 ? \"stage : Setup\" : stage == 1 ? \"stage : Register\" : stage == 2 ? \"stage : Vote\" : stage == 3 ? \"stage : Tally\" : stage == 4 ? \"stage : Finish\" : \"stage : Setup\";\n                options = [];\n                index = 0;\n\n              case 13:\n                if (!(index < option_length)) {\n                  _context3.next = 21;\n                  break;\n                }\n\n                _context3.next = 16;\n                return Vote_event.methods.return_options(index).call();\n\n              case 16:\n                temp = _context3.sent;\n                options.push(temp);\n\n              case 18:\n                index++;\n                _context3.next = 13;\n                break;\n\n              case 21:\n                return _context3.abrupt(\"return\", {\n                  address: address,\n                  Vote_event: Vote_event,\n                  stage: stage,\n                  option_length: option_length,\n                  stage_str: stage_str,\n                  options: options,\n                  mb_addr: mb_addr\n                });\n\n              case 22:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      function getInitialProps(_x) {\n        return _getInitialProps.apply(this, arguments);\n      }\n\n      return getInitialProps;\n    }()\n  }]);\n\n  return Votesss;\n}(Component);\n\nexport default Votesss;","map":{"version":3,"sources":["C:/Users/suvin/vincent/Dapp/nextjs-web/pages/Vote/vote.js"],"names":["React","Component","Link","Navbar","Nav","Container","Form","FormControl","Button","Card","web3","Router","vote","registry","show_btn","stage","Register_btn","props","state","registry_addr","register","bind","eth","getAccounts","accounts","address","Vote_event","hash","CryptoJS","SHA3","outputLength","toString","methods","send","from","pushRoute","mb_addr","alert","message","event","setState","target","value","margin","Vote_btn","vote_value","go_vote","console","log","width","marginTop","ops","map","op","Votesss","search","loading","loading2","refresh_search","color","stage_str","options","query","return_stage","call","return_options_length","option_length","index","return_options","temp","push"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport{Link}from '../../routes';\r\n\r\nimport Navbar from 'react-bootstrap/Navbar';\r\nimport Nav from 'react-bootstrap/Nav';\r\nimport Container from 'react-bootstrap/Nav';\r\nimport Form from 'react-bootstrap/Form';\r\nimport FormControl from 'react-bootstrap/FormControl';\r\nimport Button from 'react-bootstrap/Button';\r\nimport {Card} from 'react-bootstrap';\r\n\r\nimport web3 from '../../ethereum/web3'\r\nimport {Router}from '../../routes';\r\nimport vote from '../../ethereum/Vote/vote';\r\nimport registry from '../../ethereum/Vote/registry';\r\n\r\nconst show_btn = function( stage ){\r\n    if (stage != 0 ) return null;\r\n    //console.log(stage);\r\n    return (\r\n        <div>this vote still needs setting please wait</div>\r\n    );\r\n};\r\nclass Register_btn extends Component{\r\n//const register_btn =function ( stage ){\r\n    constructor(props) {\r\n        super(props);\r\n        this.state ={\r\n            registry_addr:\"\"\r\n        };\r\n        this.register = this.register.bind(this);\r\n      }\r\n      async register(){\r\n          //0x42309f924237Bac662Af64965A2efAF8c08fE4d2\r\n        const accounts = await web3.eth.getAccounts();\r\n        const Vote_event =await vote(this.props.address);\r\n        var hash = CryptoJS.SHA3(\"human\", { outputLength: 256 }).toString();\r\n        //console.log(web3.utils.fromAscii(hash));\r\n        try{\r\n            await Vote_event.methods.register('0x'+hash,this.state.registry_addr).send({from:accounts[0]});\r\n            Router.pushRoute(`/Vote/vote/${this.props.mb_addr}/${this.props.address}`);\r\n        } catch (err) {\r\n            alert(err.message);\r\n        }\r\n    }\r\n    render(){\r\n    //console.log(this.props.stage );\r\n    if (this.props.stage != 1 ) return null;\r\n  \r\n    return (\r\n        <>\r\n        <FormControl type=\"text\" placeholder=\"enter your registry number\" className=\"mr-sm-2\"\r\n                value={this.state.registry_addr} \r\n                onChange = {event => this.setState({registry_addr:event.target.value})} />\r\n        <Button variant=\"outline-info\"style={{margin :\"2%\"}} onClick={this.register}>register</Button>\r\n        </>\r\n    );\r\n    }\r\n};\r\nclass Vote_btn extends Component{\r\n//const vote_btn =function (stage ){\r\n    constructor(props) {\r\n        super(props);\r\n        this.state ={\r\n            vote_value:0\r\n        };\r\n        this.go_vote = this.go_vote.bind(this);\r\n      }\r\n    async go_vote(){\r\n        console.log(this.state.vote_value);\r\n        //const accounts = await web3.eth.getAccounts();\r\n        //await this.props.Vote_event.methods.register().send({from:accounts[0]});\r\n    }\r\n    render(){\r\n    if (this.props.stage != 2 ) return null;\r\n  \r\n    return (\r\n        <>\r\n        <Form style={{width:'33%', margin: 'auto', marginTop : \"2%\"}} onSubmit={this.go_vote}>\r\n        <Form.Group >\r\n            <Form.Control as=\"select\" size=\"lg\"value={this.state.vote_value}>\r\n                {this.props.ops.map(op => <option>{op}</option>)}\r\n                {/*<option>Korean Fish</option>\r\n                <option>Donald Trump</option>\r\n                <option>Xi DADA</option>*/}\r\n            </Form.Control>\r\n        </Form.Group>\r\n        <Button variant=\"outline-info\"style={{margin :\"2%\"}} type=\"submit\">Vote</Button>\r\n        </Form>\r\n        </>\r\n    );\r\n    }\r\n};\r\n\r\nclass Votesss extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state ={\r\n          search:\"\",\r\n          loading : false,\r\n          loading2: false,\r\n          stage:'',\r\n          search:'',\r\n          errorMessage:'',\r\n          html_test:null,\r\n          mailbox_addr:''\r\n        };\r\n      //console.log(props.query.address);//擷取這個網址的url那part的address(from routes??)  \r\n      this.refresh_search = this.refresh_search.bind(this);\r\n      \r\n      this.go_vote = this.go_vote.bind(this);\r\n      //this.see_status = this.see_status(this);\r\n      }\r\n    static async getInitialProps(props){\r\n        const{address, mb_addr} = props.query;\r\n        const Vote_event =await vote(address);\r\n        const stage = await Vote_event.methods.return_stage().call();\r\n        \r\n        const option_length = await Vote_event.methods.return_options_length().call();\r\n        const stage_str =  (stage == 0)?\"stage : Setup\":\r\n                           (stage == 1)?\"stage : Register\":\r\n                           (stage == 2)?\"stage : Vote\":\r\n                           (stage == 3)?\"stage : Tally\":\r\n                           (stage == 4)?\"stage : Finish\":\"stage : Setup\";\r\n        var options = [];\r\n        for (let index = 0; index < option_length; index++) {\r\n            let temp = await Vote_event.methods.return_options(index).call();\r\n            options.push(temp);\r\n        }\r\n        return{address,Vote_event,stage,option_length,stage_str,options,mb_addr};\r\n    }\r\n    refresh_search(){\r\n        if(this.state.search != \"\")\r\n        Router.pushRoute(`/Vote/vote/${this.state.search}`);\r\n        //console.log(this.props.address);\r\n    }\r\n    render() {\r\n        return(\r\n        <>\r\n         <link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css\" integrity=\"sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk\" crossOrigin=\"anonymous\"/>\r\n         <script src=\"https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.js\"></script>\r\n         <Container>\r\n         <Navbar bg=\"dark\" variant=\"dark\"style={{width:\"100%\"}}>\r\n            <Navbar.Brand >Vote</Navbar.Brand>\r\n             <Nav className=\"mr-auto\" style={{width:\"50%\"}}>\r\n                <Link route={\"/Vote/home/\"+ this.props.mb_addr }  ><a style={{color: \"white\", width:\"100px\"}}>Home</a></Link>\r\n                <Link route={\"/Vote/status/\"+this.props.mb_addr+\"/\"+this.props.address} ><a style={{color: \"white\", width:\"100px\"}}>Status</a></Link>\r\n                <Link route={\"/Vote/index\" }  ><a style={{color: \"white\", width:\"100px\"}}>Logout</a></Link>\r\n             </Nav>\r\n            \r\n        </Navbar>\r\n        <div style={{width: '100%'}}>\r\n\r\n        <Form inline style={{ width: '33%' , margin: 'auto' , marginTop : \"2%\"}}>\r\n            <div style={{color : \"black\"}} > inesrt your vote contract address here  -&gt;   </div>\r\n            <FormControl type=\"text\" placeholder=\"Search\" className=\"mr-sm-2\"\r\n                value={this.state.search} \r\n                onChange = {event => this.setState({search:event.target.value})} />\r\n            <Button variant=\"outline-info\" onClick={this.refresh_search}>Search</Button>\r\n            </Form>\r\n        <Card style={{ width: '33%' , margin: 'auto' , marginTop : \"2%\"}}>\r\n            <Card.Body>\r\n                <Card.Title>Election</Card.Title>\r\n                <Card.Subtitle className=\"mb-2 text-muted\">voter address : {this.props.address}</Card.Subtitle>\r\n                <Card.Text>\r\n                    View the latest 2020 presidential polls and head-to-head match-up between Joe Biden and Donald Trump. For more information, view cnn.com/election.\r\n                </Card.Text>\r\n                <Card.Text>{this.props.stage_str}</Card.Text>\r\n                {show_btn(this.props.stage)}\r\n                <Register_btn stage ={this.props.stage} address = {this.props.address} mb_addr={this.props.mb_addr}></Register_btn>\r\n                <Vote_btn stage ={this.props.stage} ops = {this.props.options} address = {this.props.address} mb_addr={this.props.mb_addr}></Vote_btn>\r\n            </Card.Body>\r\n        </Card>\r\n        </div>\r\n        <div style={{ width: '100%'}}>\r\n        </div>\r\n      </Container>\r\n        </>\r\n    )\r\n    }\r\n}\r\n\r\n\r\nexport default Votesss;"]},"metadata":{},"sourceType":"module"}